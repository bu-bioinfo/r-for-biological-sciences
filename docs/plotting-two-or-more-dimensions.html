<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.5 Plotting Two or More Dimensions | BF591 - R for Biological Sciences</title>
  <meta name="description" content="7.5 Plotting Two or More Dimensions | BF591 - R for Biological Sciences" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7.5 Plotting Two or More Dimensions | BF591 - R for Biological Sciences" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.5 Plotting Two or More Dimensions | BF591 - R for Biological Sciences" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="visualizing-distributions.html"/>
<link rel="next" href="other-kind-of-plots.html"/>
<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#syllabus">Syllabus<span></span></a>
<ul>
<li><a href="course-schedule.html#course-schedule">Course Schedule<span></span></a></li>
<li><a href="instructors.html#instructors">Instructors<span></span></a></li>
<li><a href="office-hours.html#office-hours">Office Hours<span></span></a></li>
<li><a href="course-values-and-policies.html#course-values-and-policies">Course Values and Policies<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="who-this-book-is-for.html"><a href="who-this-book-is-for.html"><i class="fa fa-check"></i><b>1.1</b> Who This Book Is For<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="a-note-about-reinventing-the-wheel.html"><a href="a-note-about-reinventing-the-wheel.html"><i class="fa fa-check"></i><b>1.2</b> A Note About Reinventing the Wheel<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="sources-and-references.html"><a href="sources-and-references.html"><i class="fa fa-check"></i><b>1.3</b> Sources and References<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-bio.html"><a href="data-bio.html"><i class="fa fa-check"></i><b>2</b> Data in Biology<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-brief-history-of-data-in-molecular-biology.html"><a href="a-brief-history-of-data-in-molecular-biology.html"><i class="fa fa-check"></i><b>2.1</b> A Brief History of Data in Molecular Biology<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="biology-as-a-mature-data-science.html"><a href="biology-as-a-mature-data-science.html"><i class="fa fa-check"></i><b>2.2</b> Biology as a Mature Data Science<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>3</b> Preliminaries<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="prelim-r.html"><a href="prelim-r.html"><i class="fa fa-check"></i><b>3.1</b> The R Language<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="prelim-rstudio.html"><a href="prelim-rstudio.html"><i class="fa fa-check"></i><b>3.2</b> RStudio<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="prog-the-r-script.html"><a href="prog-the-r-script.html"><i class="fa fa-check"></i><b>3.3</b> The R Script<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="prog-workflow.html"><a href="prog-workflow.html"><i class="fa fa-check"></i><b>3.4</b> The Scripting Workflow<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="prelim-git.html"><a href="prelim-git.html"><i class="fa fa-check"></i><b>3.5</b> git + github<span></span></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="prelim-git.html"><a href="prelim-git.html#motivation"><i class="fa fa-check"></i><b>3.5.1</b> Motivation<span></span></a></li>
<li class="chapter" data-level="3.5.2" data-path="prelim-git.html"><a href="prelim-git.html#git"><i class="fa fa-check"></i><b>3.5.2</b> git<span></span></a></li>
<li class="chapter" data-level="3.5.3" data-path="prelim-git.html"><a href="prelim-git.html#git-hosting-platforms-github"><i class="fa fa-check"></i><b>3.5.3</b> Git hosting platforms (GitHub)<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prog-basics.html"><a href="prog-basics.html"><i class="fa fa-check"></i><b>4</b> R Programming<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="before-you-begin.html"><a href="before-you-begin.html"><i class="fa fa-check"></i><b>4.1</b> Before you begin<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>4.2</b> Introduction<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="prog-r-syntax.html"><a href="prog-r-syntax.html"><i class="fa fa-check"></i><b>4.3</b> R Syntax Basics<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="prog-types.html"><a href="prog-types.html"><i class="fa fa-check"></i><b>4.4</b> Basic Types of Values<span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="prog-types.html"><a href="prog-types.html#factors"><i class="fa fa-check"></i><b>4.4.1</b> Factors<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="prog-struct.html"><a href="prog-struct.html"><i class="fa fa-check"></i><b>4.5</b> Data Structures<span></span></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="prog-struct.html"><a href="prog-struct.html#vectors"><i class="fa fa-check"></i><b>4.5.1</b> Vectors<span></span></a></li>
<li class="chapter" data-level="4.5.2" data-path="prog-struct.html"><a href="prog-struct.html#matrices"><i class="fa fa-check"></i><b>4.5.2</b> Matrices<span></span></a></li>
<li class="chapter" data-level="4.5.3" data-path="prog-struct.html"><a href="prog-struct.html#lists-and-data-frames"><i class="fa fa-check"></i><b>4.5.3</b> Lists and data frames<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="logical-tests-and-comparators.html"><a href="logical-tests-and-comparators.html"><i class="fa fa-check"></i><b>4.6</b> Logical Tests and Comparators<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4.7</b> Functions<span></span></a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="functions.html"><a href="functions.html#prog-dry"><i class="fa fa-check"></i><b>4.7.1</b> DRY: Don’t Repeat Yourself<span></span></a></li>
<li class="chapter" data-level="4.7.2" data-path="functions.html"><a href="functions.html#writing-your-own-functions"><i class="fa fa-check"></i><b>4.7.2</b> Writing your own functions<span></span></a></li>
<li class="chapter" data-level="4.7.3" data-path="functions.html"><a href="functions.html#scope"><i class="fa fa-check"></i><b>4.7.3</b> Scope<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>4.8</b> Iteration<span></span></a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="iteration.html"><a href="iteration.html#vectorized-operations"><i class="fa fa-check"></i><b>4.8.1</b> Vectorized operations<span></span></a></li>
<li class="chapter" data-level="4.8.2" data-path="iteration.html"><a href="iteration.html#functional-programming"><i class="fa fa-check"></i><b>4.8.2</b> Functional programming<span></span></a></li>
<li class="chapter" data-level="4.8.3" data-path="iteration.html"><a href="iteration.html#apply-and-friends"><i class="fa fa-check"></i><b>4.8.3</b> <code>apply()</code> and friends<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="installing-packages.html"><a href="installing-packages.html"><i class="fa fa-check"></i><b>4.9</b> Installing Packages<span></span></a></li>
<li class="chapter" data-level="4.10" data-path="saving-and-loading-r-data.html"><a href="saving-and-loading-r-data.html"><i class="fa fa-check"></i><b>4.10</b> Saving and Loading R Data<span></span></a></li>
<li class="chapter" data-level="4.11" data-path="prog-debugging.html"><a href="prog-debugging.html"><i class="fa fa-check"></i><b>4.11</b> Troubleshooting and Debugging<span></span></a></li>
<li class="chapter" data-level="4.12" data-path="prog-style.html"><a href="prog-style.html"><i class="fa fa-check"></i><b>4.12</b> Coding Style and Conventions<span></span></a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="prog-style.html"><a href="prog-style.html#is-my-code-correct"><i class="fa fa-check"></i><b>4.12.1</b> Is my code correct?<span></span></a></li>
<li class="chapter" data-level="4.12.2" data-path="prog-style.html"><a href="prog-style.html#does-my-code-follow-the-dry-principle"><i class="fa fa-check"></i><b>4.12.2</b> Does my code follow the <span>DRY principle</span>?<span></span></a></li>
<li class="chapter" data-level="4.12.3" data-path="prog-style.html"><a href="prog-style.html#did-i-choose-concise-but-descriptive-variable-and-function-names"><i class="fa fa-check"></i><b>4.12.3</b> Did I choose concise but descriptive variable and function names?<span></span></a></li>
<li class="chapter" data-level="4.12.4" data-path="prog-style.html"><a href="prog-style.html#did-i-use-indentation-and-naming-conventions-consistently-throughout-my-code"><i class="fa fa-check"></i><b>4.12.4</b> Did I use indentation and naming conventions consistently throughout my code?<span></span></a></li>
<li class="chapter" data-level="4.12.5" data-path="prog-style.html"><a href="prog-style.html#did-i-write-comments-especially-when-what-the-code-does-is-not-obvious"><i class="fa fa-check"></i><b>4.12.5</b> Did I write comments, especially when what the code does is not obvious?<span></span></a></li>
<li class="chapter" data-level="4.12.6" data-path="prog-style.html"><a href="prog-style.html#how-easy-would-it-be-for-someone-else-to-understand-my-code"><i class="fa fa-check"></i><b>4.12.6</b> How easy would it be for someone else to understand my code?<span></span></a></li>
<li class="chapter" data-level="4.12.7" data-path="prog-style.html"><a href="prog-style.html#is-my-code-easy-to-maintainchange"><i class="fa fa-check"></i><b>4.12.7</b> Is my code easy to maintain/change?<span></span></a></li>
<li class="chapter" data-level="4.12.8" data-path="prog-style.html"><a href="prog-style.html#the-styler-package"><i class="fa fa-check"></i><b>4.12.8</b> The <code>styler</code> package<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>5</b> Data Wrangling<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-tidyverse.html"><a href="the-tidyverse.html"><i class="fa fa-check"></i><b>5.1</b> The Tidyverse<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="dw-basics.html"><a href="dw-basics.html"><i class="fa fa-check"></i><b>5.2</b> Tidyverse Basics<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="importing-data.html"><a href="importing-data.html"><i class="fa fa-check"></i><b>5.3</b> Importing Data<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="data-tibble.html"><a href="data-tibble.html"><i class="fa fa-check"></i><b>5.4</b> The tibble<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>5.5</b> Tidy Data<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="pipes.html"><a href="pipes.html"><i class="fa fa-check"></i><b>5.6</b> pipes<span></span></a></li>
<li class="chapter" data-level="5.7" data-path="arranging-data.html"><a href="arranging-data.html"><i class="fa fa-check"></i><b>5.7</b> Arranging Data<span></span></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="arranging-data.html"><a href="arranging-data.html#dplyrmutate---create-new-columns-using-other-columns"><i class="fa fa-check"></i><b>5.7.1</b> <code>dplyr::mutate()</code> - Create new columns using other columns<span></span></a></li>
<li class="chapter" data-level="5.7.2" data-path="arranging-data.html"><a href="arranging-data.html#stringr---working-with-character-values"><i class="fa fa-check"></i><b>5.7.2</b> <code>stringr</code> - Working with character values<span></span></a></li>
<li class="chapter" data-level="5.7.3" data-path="arranging-data.html"><a href="arranging-data.html#dplyrselect---subset-columns-by-name"><i class="fa fa-check"></i><b>5.7.3</b> <code>dplyr::select()</code> - Subset Columns by Name<span></span></a></li>
<li class="chapter" data-level="5.7.4" data-path="arranging-data.html"><a href="arranging-data.html#dplyrfilter---pick-rows-out-of-a-data-set"><i class="fa fa-check"></i><b>5.7.4</b> <code>dplyr::filter()</code> - Pick rows out of a data set<span></span></a></li>
<li class="chapter" data-level="5.7.5" data-path="arranging-data.html"><a href="arranging-data.html#dplyrarrange---order-rows-based-on-their-values"><i class="fa fa-check"></i><b>5.7.5</b> <code>dplyr::arrange()</code> - Order rows based on their values<span></span></a></li>
<li class="chapter" data-level="5.7.6" data-path="arranging-data.html"><a href="arranging-data.html#putting-it-all-together"><i class="fa fa-check"></i><b>5.7.6</b> Putting it all together<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="grouping-data.html"><a href="grouping-data.html"><i class="fa fa-check"></i><b>5.8</b> Grouping Data<span></span></a></li>
<li class="chapter" data-level="5.9" data-path="rearranging-data.html"><a href="rearranging-data.html"><i class="fa fa-check"></i><b>5.9</b> Rearranging Data<span></span></a></li>
<li class="chapter" data-level="5.10" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>5.10</b> Relational Data<span></span></a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="relational-data.html"><a href="relational-data.html#dealing-with-multiple-matches"><i class="fa fa-check"></i><b>5.10.1</b> Dealing with multiple matches<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>6</b> Data Science<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-modeling.html"><a href="data-modeling.html"><i class="fa fa-check"></i><b>6.1</b> Data Modeling<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-modeling.html"><a href="data-modeling.html#a-worked-modeling-example"><i class="fa fa-check"></i><b>6.1.1</b> A Worked Modeling Example<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="data-modeling.html"><a href="data-modeling.html#data-summarization"><i class="fa fa-check"></i><b>6.1.2</b> Data Summarization<span></span></a></li>
<li class="chapter" data-level="6.1.3" data-path="data-modeling.html"><a href="data-modeling.html#linear-models"><i class="fa fa-check"></i><b>6.1.3</b> Linear Models<span></span></a></li>
<li class="chapter" data-level="6.1.4" data-path="data-modeling.html"><a href="data-modeling.html#flavors-of-linear-models"><i class="fa fa-check"></i><b>6.1.4</b> Flavors of Linear Models<span></span></a></li>
<li class="chapter" data-level="6.1.5" data-path="data-modeling.html"><a href="data-modeling.html#assessing-model-accuracy-."><i class="fa fa-check"></i><b>6.1.5</b> Assessing Model Accuracy .<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html"><i class="fa fa-check"></i><b>6.2</b> Statistical Distributions<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="statistical-distributions.html"><a href="statistical-distributions.html#random-variables"><i class="fa fa-check"></i><b>6.2.1</b> Random Variables<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="statistical-distributions.html"><a href="statistical-distributions.html#statistical-distribution-basics"><i class="fa fa-check"></i><b>6.2.2</b> Statistical Distribution Basics<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="statistical-distributions.html"><a href="statistical-distributions.html#distributions-in-r"><i class="fa fa-check"></i><b>6.2.3</b> Distributions in R<span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="statistical-distributions.html"><a href="statistical-distributions.html#discrete-distributions"><i class="fa fa-check"></i><b>6.2.4</b> Discrete Distributions<span></span></a></li>
<li class="chapter" data-level="6.2.5" data-path="statistical-distributions.html"><a href="statistical-distributions.html#continuous-distributions"><i class="fa fa-check"></i><b>6.2.5</b> Continuous Distributions<span></span></a></li>
<li class="chapter" data-level="6.2.6" data-path="statistical-distributions.html"><a href="statistical-distributions.html#empirical-distributions"><i class="fa fa-check"></i><b>6.2.6</b> Empirical Distributions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="statistical-tests.html"><a href="statistical-tests.html"><i class="fa fa-check"></i><b>6.3</b> Statistical Tests<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="statistical-tests.html"><a href="statistical-tests.html#what-is-a-statistical-test"><i class="fa fa-check"></i><b>6.3.1</b> What is a statistical test<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="statistical-tests.html"><a href="statistical-tests.html#common-statistical-tests"><i class="fa fa-check"></i><b>6.3.2</b> Common Statistical Tests<span></span></a></li>
<li class="chapter" data-level="6.3.3" data-path="statistical-tests.html"><a href="statistical-tests.html#choosing-a-test"><i class="fa fa-check"></i><b>6.3.3</b> Choosing a Test<span></span></a></li>
<li class="chapter" data-level="6.3.4" data-path="statistical-tests.html"><a href="statistical-tests.html#p-values"><i class="fa fa-check"></i><b>6.3.4</b> P-values<span></span></a></li>
<li class="chapter" data-level="6.3.5" data-path="statistical-tests.html"><a href="statistical-tests.html#multiple-hypothesis-testing-."><i class="fa fa-check"></i><b>6.3.5</b> Multiple Hypothesis Testing .<span></span></a></li>
<li class="chapter" data-level="6.3.6" data-path="statistical-tests.html"><a href="statistical-tests.html#statistical-power"><i class="fa fa-check"></i><b>6.3.6</b> Statistical power<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>6.4</b> Exploratory Data Analysis<span></span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#principal-component-analysis"><i class="fa fa-check"></i><b>6.4.1</b> Principal Component Analysis<span></span></a></li>
<li class="chapter" data-level="6.4.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#cluster-analysis"><i class="fa fa-check"></i><b>6.4.2</b> Cluster Analysis<span></span></a></li>
<li class="chapter" data-level="6.4.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#k-means-."><i class="fa fa-check"></i><b>6.4.3</b> k-means .<span></span></a></li>
<li class="chapter" data-level="6.4.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#others"><i class="fa fa-check"></i><b>6.4.4</b> Others<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="network-analysis-..html"><a href="network-analysis-..html"><i class="fa fa-check"></i><b>6.5</b> Network Analysis .<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>7</b> Data Visualization<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="responsible-plotting.html"><a href="responsible-plotting.html"><i class="fa fa-check"></i><b>7.1</b> Responsible Plotting<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="responsible-plotting.html"><a href="responsible-plotting.html#visualization-principles"><i class="fa fa-check"></i><b>7.1.1</b> Visualization Principles<span></span></a></li>
<li class="chapter" data-level="7.1.2" data-path="responsible-plotting.html"><a href="responsible-plotting.html#human-visual-perception"><i class="fa fa-check"></i><b>7.1.2</b> Human Visual Perception<span></span></a></li>
<li class="chapter" data-level="7.1.3" data-path="responsible-plotting.html"><a href="responsible-plotting.html#visual-encodings"><i class="fa fa-check"></i><b>7.1.3</b> Visual Encodings<span></span></a></li>
<li class="chapter" data-level="7.1.4" data-path="responsible-plotting.html"><a href="responsible-plotting.html#some-opinionated-rules-of-thumb"><i class="fa fa-check"></i><b>7.1.4</b> Some Opinionated Rules of Thumb<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="dv-gg.html"><a href="dv-gg.html"><i class="fa fa-check"></i><b>7.2</b> Grammar of Graphics<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="dv-gg.html"><a href="dv-gg.html#ggplot-mechanics"><i class="fa fa-check"></i><b>7.2.1</b> <code>ggplot</code> mechanics<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="plotting-one-dimension.html"><a href="plotting-one-dimension.html"><i class="fa fa-check"></i><b>7.3</b> Plotting One Dimension<span></span></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="plotting-one-dimension.html"><a href="plotting-one-dimension.html#dv-bar"><i class="fa fa-check"></i><b>7.3.1</b> Bar chart<span></span></a></li>
<li class="chapter" data-level="7.3.2" data-path="plotting-one-dimension.html"><a href="plotting-one-dimension.html#lollipop-plots"><i class="fa fa-check"></i><b>7.3.2</b> Lollipop plots<span></span></a></li>
<li class="chapter" data-level="7.3.3" data-path="plotting-one-dimension.html"><a href="plotting-one-dimension.html#stacked-area-charts"><i class="fa fa-check"></i><b>7.3.3</b> Stacked Area charts<span></span></a></li>
<li class="chapter" data-level="7.3.4" data-path="plotting-one-dimension.html"><a href="plotting-one-dimension.html#parallel-coordinate-plots"><i class="fa fa-check"></i><b>7.3.4</b> Parallel Coordinate plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="visualizing-distributions.html"><a href="visualizing-distributions.html"><i class="fa fa-check"></i><b>7.4</b> Visualizing Distributions<span></span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="visualizing-distributions.html"><a href="visualizing-distributions.html#histogram"><i class="fa fa-check"></i><b>7.4.1</b> Histogram<span></span></a></li>
<li class="chapter" data-level="7.4.2" data-path="visualizing-distributions.html"><a href="visualizing-distributions.html#density"><i class="fa fa-check"></i><b>7.4.2</b> Density<span></span></a></li>
<li class="chapter" data-level="7.4.3" data-path="visualizing-distributions.html"><a href="visualizing-distributions.html#boxplot"><i class="fa fa-check"></i><b>7.4.3</b> Boxplot<span></span></a></li>
<li class="chapter" data-level="7.4.4" data-path="visualizing-distributions.html"><a href="visualizing-distributions.html#violin-plot"><i class="fa fa-check"></i><b>7.4.4</b> Violin plot<span></span></a></li>
<li class="chapter" data-level="7.4.5" data-path="visualizing-distributions.html"><a href="visualizing-distributions.html#beeswarm-plot"><i class="fa fa-check"></i><b>7.4.5</b> Beeswarm plot<span></span></a></li>
<li class="chapter" data-level="7.4.6" data-path="visualizing-distributions.html"><a href="visualizing-distributions.html#ridgeline"><i class="fa fa-check"></i><b>7.4.6</b> Ridgeline<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html"><i class="fa fa-check"></i><b>7.5</b> Plotting Two or More Dimensions<span></span></a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html#scatter-plots"><i class="fa fa-check"></i><b>7.5.1</b> Scatter Plots<span></span></a></li>
<li class="chapter" data-level="7.5.2" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html#bubble-plots"><i class="fa fa-check"></i><b>7.5.2</b> Bubble Plots<span></span></a></li>
<li class="chapter" data-level="7.5.3" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html#connected-scatter-plots"><i class="fa fa-check"></i><b>7.5.3</b> Connected Scatter Plots<span></span></a></li>
<li class="chapter" data-level="7.5.4" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html#line-plots"><i class="fa fa-check"></i><b>7.5.4</b> Line Plots<span></span></a></li>
<li class="chapter" data-level="7.5.5" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html#parallel-coordinate-plots-1"><i class="fa fa-check"></i><b>7.5.5</b> Parallel Coordinate Plots<span></span></a></li>
<li class="chapter" data-level="7.5.6" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html#heatmaps"><i class="fa fa-check"></i><b>7.5.6</b> Heatmaps<span></span></a></li>
<li class="chapter" data-level="7.5.7" data-path="plotting-two-or-more-dimensions.html"><a href="plotting-two-or-more-dimensions.html#how-to-use-heatmaps-responsibly"><i class="fa fa-check"></i><b>7.5.7</b> How To Use Heatmaps Responsibly<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="other-kind-of-plots.html"><a href="other-kind-of-plots.html"><i class="fa fa-check"></i><b>7.6</b> Other Kind of Plots<span></span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="other-kind-of-plots.html"><a href="other-kind-of-plots.html#dendrograms"><i class="fa fa-check"></i><b>7.6.1</b> Dendrograms<span></span></a></li>
<li class="chapter" data-level="7.6.2" data-path="other-kind-of-plots.html"><a href="other-kind-of-plots.html#chord-diagrams-and-circos-plots"><i class="fa fa-check"></i><b>7.6.2</b> Chord Diagrams and Circos Plots<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="multiple-plots.html"><a href="multiple-plots.html"><i class="fa fa-check"></i><b>7.7</b> Multiple Plots<span></span></a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="multiple-plots.html"><a href="multiple-plots.html#facet-wrapping"><i class="fa fa-check"></i><b>7.7.1</b> Facet wrapping<span></span></a></li>
<li class="chapter" data-level="7.7.2" data-path="multiple-plots.html"><a href="multiple-plots.html#multipanel-figures"><i class="fa fa-check"></i><b>7.7.2</b> Multipanel Figures<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="publication-ready-plots.html"><a href="publication-ready-plots.html"><i class="fa fa-check"></i><b>7.8</b> Publication Ready Plots<span></span></a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="publication-ready-plots.html"><a href="publication-ready-plots.html#ggplot-themes"><i class="fa fa-check"></i><b>7.8.1</b> <code>ggplot</code> Themes<span></span></a></li>
<li class="chapter" data-level="7.8.2" data-path="publication-ready-plots.html"><a href="publication-ready-plots.html#exporting-to-svg"><i class="fa fa-check"></i><b>7.8.2</b> Exporting to SVG<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="network-visualization.html"><a href="network-visualization.html"><i class="fa fa-check"></i><b>7.9</b> Network visualization<span></span></a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="network-visualization.html"><a href="network-visualization.html#interactive-network-plots"><i class="fa fa-check"></i><b>7.9.1</b> Interactive network plots<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="biology-bioinformatics.html"><a href="biology-bioinformatics.html"><i class="fa fa-check"></i><b>8</b> Biology &amp; Bioinformatics<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="bio-r.html"><a href="bio-r.html"><i class="fa fa-check"></i><b>8.1</b> R in Biology<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="biological-data-overview.html"><a href="biological-data-overview.html"><i class="fa fa-check"></i><b>8.2</b> Biological Data Overview<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="biological-data-overview.html"><a href="biological-data-overview.html#bio-data-types"><i class="fa fa-check"></i><b>8.2.1</b> Types of Biological Data<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="biological-data-overview.html"><a href="biological-data-overview.html#csv-files"><i class="fa fa-check"></i><b>8.2.2</b> CSV Files<span></span></a></li>
<li class="chapter" data-level="8.2.3" data-path="biological-data-overview.html"><a href="biological-data-overview.html#biological-data-is-not-tidy"><i class="fa fa-check"></i><b>8.2.3</b> Biological data is NOT Tidy!<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="bio-bioconductor.html"><a href="bio-bioconductor.html"><i class="fa fa-check"></i><b>8.3</b> Bioconductor<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="microarrays.html"><a href="microarrays.html"><i class="fa fa-check"></i><b>8.4</b> Microarrays<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="high-throughput-sequencing.html"><a href="high-throughput-sequencing.html"><i class="fa fa-check"></i><b>8.5</b> High Throughput Sequencing<span></span></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="high-throughput-sequencing.html"><a href="high-throughput-sequencing.html#raw-hts-data"><i class="fa fa-check"></i><b>8.5.1</b> Raw HTS Data<span></span></a></li>
<li class="chapter" data-level="8.5.2" data-path="high-throughput-sequencing.html"><a href="high-throughput-sequencing.html#preliminary-hts-data-analysis"><i class="fa fa-check"></i><b>8.5.2</b> Preliminary HTS Data Analysis<span></span></a></li>
<li class="chapter" data-level="8.5.3" data-path="high-throughput-sequencing.html"><a href="high-throughput-sequencing.html#count-data"><i class="fa fa-check"></i><b>8.5.3</b> Count Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="gene-identifiers.html"><a href="gene-identifiers.html"><i class="fa fa-check"></i><b>8.6</b> Gene Identifiers<span></span></a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="gene-identifiers.html"><a href="gene-identifiers.html#gene-identifier-systems"><i class="fa fa-check"></i><b>8.6.1</b> Gene Identifier Systems<span></span></a></li>
<li class="chapter" data-level="8.6.2" data-path="gene-identifiers.html"><a href="gene-identifiers.html#mapping-between-identifier-systems"><i class="fa fa-check"></i><b>8.6.2</b> Mapping Between Identifier Systems<span></span></a></li>
<li class="chapter" data-level="8.6.3" data-path="gene-identifiers.html"><a href="gene-identifiers.html#mapping-homologs"><i class="fa fa-check"></i><b>8.6.3</b> Mapping Homologs<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="gene-expression.html"><a href="gene-expression.html"><i class="fa fa-check"></i><b>8.7</b> Gene Expression<span></span></a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="gene-expression.html"><a href="gene-expression.html#gene-expression-data-in-bioconductor"><i class="fa fa-check"></i><b>8.7.1</b> Gene Expression Data in Bioconductor<span></span></a></li>
<li class="chapter" data-level="8.7.2" data-path="gene-expression.html"><a href="gene-expression.html#differential-expression-analysis"><i class="fa fa-check"></i><b>8.7.2</b> Differential Expression Analysis<span></span></a></li>
<li class="chapter" data-level="8.7.3" data-path="gene-expression.html"><a href="gene-expression.html#microarray-gene-expression-data"><i class="fa fa-check"></i><b>8.7.3</b> Microarray Gene Expression Data<span></span></a></li>
<li class="chapter" data-level="8.7.4" data-path="gene-expression.html"><a href="gene-expression.html#differential-expression-microarrays-limma"><i class="fa fa-check"></i><b>8.7.4</b> Differential Expression: Microarrays (limma)<span></span></a></li>
<li class="chapter" data-level="8.7.5" data-path="gene-expression.html"><a href="gene-expression.html#rnaseq"><i class="fa fa-check"></i><b>8.7.5</b> RNASeq<span></span></a></li>
<li class="chapter" data-level="8.7.6" data-path="gene-expression.html"><a href="gene-expression.html#rnaseq-gene-expression-data"><i class="fa fa-check"></i><b>8.7.6</b> RNASeq Gene Expression Data<span></span></a></li>
<li class="chapter" data-level="8.7.7" data-path="gene-expression.html"><a href="gene-expression.html#filtering-counts"><i class="fa fa-check"></i><b>8.7.7</b> Filtering Counts<span></span></a></li>
<li class="chapter" data-level="8.7.8" data-path="gene-expression.html"><a href="gene-expression.html#count-distributions"><i class="fa fa-check"></i><b>8.7.8</b> Count Distributions<span></span></a></li>
<li class="chapter" data-level="8.7.9" data-path="gene-expression.html"><a href="gene-expression.html#differential-expression-rnaseq"><i class="fa fa-check"></i><b>8.7.9</b> Differential Expression: RNASeq<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="gene-set-enrichment-analysis.html"><a href="gene-set-enrichment-analysis.html"><i class="fa fa-check"></i><b>8.8</b> Gene Set Enrichment Analysis<span></span></a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="gene-set-enrichment-analysis.html"><a href="gene-set-enrichment-analysis.html#gene-sets"><i class="fa fa-check"></i><b>8.8.1</b> Gene Sets<span></span></a></li>
<li class="chapter" data-level="8.8.2" data-path="gene-set-enrichment-analysis.html"><a href="gene-set-enrichment-analysis.html#working-with-gene-sets-in-r"><i class="fa fa-check"></i><b>8.8.2</b> Working with gene sets in R<span></span></a></li>
<li class="chapter" data-level="8.8.3" data-path="gene-set-enrichment-analysis.html"><a href="gene-set-enrichment-analysis.html#over-representation-analysis"><i class="fa fa-check"></i><b>8.8.3</b> Over-representation Analysis<span></span></a></li>
<li class="chapter" data-level="8.8.4" data-path="gene-set-enrichment-analysis.html"><a href="gene-set-enrichment-analysis.html#rank-based-analysis"><i class="fa fa-check"></i><b>8.8.4</b> Rank-based Analysis<span></span></a></li>
<li class="chapter" data-level="8.8.5" data-path="gene-set-enrichment-analysis.html"><a href="gene-set-enrichment-analysis.html#fgsea"><i class="fa fa-check"></i><b>8.8.5</b> fgsea<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="biological-networks-..html"><a href="biological-networks-..html"><i class="fa fa-check"></i><b>8.9</b> Biological Networks .<span></span></a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="biological-networks-..html"><a href="biological-networks-..html#biological-pathways-."><i class="fa fa-check"></i><b>8.9.1</b> Biological Pathways .<span></span></a></li>
<li class="chapter" data-level="8.9.2" data-path="biological-networks-..html"><a href="biological-networks-..html#gene-regulatory-networks-."><i class="fa fa-check"></i><b>8.9.2</b> Gene Regulatory Networks .<span></span></a></li>
<li class="chapter" data-level="8.9.3" data-path="biological-networks-..html"><a href="biological-networks-..html#protein-protein-interaction-network-."><i class="fa fa-check"></i><b>8.9.3</b> Protein-Protein Interaction Network .<span></span></a></li>
<li class="chapter" data-level="8.9.4" data-path="biological-networks-..html"><a href="biological-networks-..html#wgcna-."><i class="fa fa-check"></i><b>8.9.4</b> WGCNA .<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="single-cell-sequencing-analysis-..html"><a href="single-cell-sequencing-analysis-..html"><i class="fa fa-check"></i><b>8.10</b> Single Cell Sequencing Analysis .<span></span></a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="single-cell-sequencing-analysis-..html"><a href="single-cell-sequencing-analysis-..html#single-cell-sequencing-."><i class="fa fa-check"></i><b>8.10.1</b> Single Cell Sequencing .<span></span></a></li>
<li class="chapter" data-level="8.10.2" data-path="single-cell-sequencing-analysis-..html"><a href="single-cell-sequencing-analysis-..html#single-cell-analysis-."><i class="fa fa-check"></i><b>8.10.2</b> Single Cell Analysis .<span></span></a></li>
<li class="chapter" data-level="8.10.3" data-path="single-cell-sequencing-analysis-..html"><a href="single-cell-sequencing-analysis-..html#single-cell-clustering-."><i class="fa fa-check"></i><b>8.10.3</b> Single Cell Clustering .<span></span></a></li>
<li class="chapter" data-level="8.10.4" data-path="single-cell-sequencing-analysis-..html"><a href="single-cell-sequencing-analysis-..html#dimensionality-reduction-projection-."><i class="fa fa-check"></i><b>8.10.4</b> Dimensionality Reduction &amp; Projection .<span></span></a></li>
<li class="chapter" data-level="8.10.5" data-path="single-cell-sequencing-analysis-..html"><a href="single-cell-sequencing-analysis-..html#single-cell-data-visualization-."><i class="fa fa-check"></i><b>8.10.5</b> Single Cell Data Visualization .<span></span></a></li>
<li class="chapter" data-level="8.10.6" data-path="single-cell-sequencing-analysis-..html"><a href="single-cell-sequencing-analysis-..html#single-cell-marker-analysis-."><i class="fa fa-check"></i><b>8.10.6</b> Single Cell Marker Analysis .<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="engineering.html"><a href="engineering.html"><i class="fa fa-check"></i><b>9</b> EngineeRing<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="unit-testing.html"><a href="unit-testing.html"><i class="fa fa-check"></i><b>9.1</b> Unit Testing<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="object-orientation-in-r-..html"><a href="object-orientation-in-r-..html"><i class="fa fa-check"></i><b>9.2</b> Object Orientation in R .<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="toolification-..html"><a href="toolification-..html"><i class="fa fa-check"></i><b>9.3</b> Toolification .<span></span></a></li>
<li class="chapter" data-level="9.4" data-path="pipelines-workflows-..html"><a href="pipelines-workflows-..html"><i class="fa fa-check"></i><b>9.4</b> Pipelines &amp; Workflows .<span></span></a></li>
<li class="chapter" data-level="9.5" data-path="parallel-processing-..html"><a href="parallel-processing-..html"><i class="fa fa-check"></i><b>9.5</b> Parallel Processing .<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="r-packages-..html"><a href="r-packages-..html"><i class="fa fa-check"></i><b>9.6</b> R Packages .<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="r-shiny.html"><a href="r-shiny.html"><i class="fa fa-check"></i><b>10</b> R Shiny<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>10.1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="introduction-2.html"><a href="introduction-2.html#how-does-a-web-page-work"><i class="fa fa-check"></i><b>10.1.1</b> How does a web page work?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="application-structure.html"><a href="application-structure.html"><i class="fa fa-check"></i><b>10.2</b> Application Structure<span></span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="application-structure.html"><a href="application-structure.html#ui-design"><i class="fa fa-check"></i><b>10.2.1</b> UI Design<span></span></a></li>
<li class="chapter" data-level="10.2.2" data-path="application-structure.html"><a href="application-structure.html#server-functionality"><i class="fa fa-check"></i><b>10.2.2</b> Server Functionality<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="reactivity.html"><a href="reactivity.html"><i class="fa fa-check"></i><b>10.3</b> Reactivity<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="publishing.html"><a href="publishing.html"><i class="fa fa-check"></i><b>10.4</b> Publishing<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>10.5</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="communicating-with-r.html"><a href="communicating-with-r.html"><i class="fa fa-check"></i><b>11</b> Communicating with R<span></span></a>
<ul>
<li class="chapter" data-level="11.1" data-path="rmarkdown-knitr.html"><a href="rmarkdown-knitr.html"><i class="fa fa-check"></i><b>11.1</b> RMarkdown &amp; knitr<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="bookdown.html"><a href="bookdown.html"><i class="fa fa-check"></i><b>11.2</b> bookdown<span></span></a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="contribution-guide.html"><a href="contribution-guide.html"><i class="fa fa-check"></i><b>12</b> Contribution Guide<span></span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="custom-blocks.html"><a href="custom-blocks.html"><i class="fa fa-check"></i><b>12.1</b> Custom blocks<span></span></a></li>
</ul></li>
<li><a href="assignments.html#assignments">Assignments<span></span></a>
<ul>
<li><a href="assignment-format.html#assignment-format">Assignment Format<span></span></a></li>
<li><a href="starting-an-assignment.html#starting-an-assignment">Starting an Assignment<span></span></a>
<ul>
<li><a href="starting-an-assignment.html#starting-your-own-git-repository-and-cloning-it">Starting your own <code>git</code> repository and cloning it<span></span></a></li>
<li><a href="starting-an-assignment.html#contents">Contents<span></span></a></li>
<li><a href="starting-an-assignment.html#github-tutorial">GitHub tutorial<span></span></a></li>
<li><a href="starting-an-assignment.html#committing-and-pushing-with-r-and-without">Committing and Pushing with R (and without)<span></span></a></li>
<li><a href="starting-an-assignment.html#using-rstudio">Using RStudio<span></span></a></li>
<li><a href="starting-an-assignment.html#using-the-command-line">Using the command line<span></span></a></li>
</ul></li>
<li><a href="assignment-1.html#assignment-1">Assignment 1<span></span></a>
<ul>
<li><a href="assignment-1.html#problem-statement">Problem Statement<span></span></a></li>
<li><a href="assignment-1.html#learning-objectives-and-skill-list">Learning Objectives and Skill List<span></span></a></li>
<li><a href="assignment-1.html#instructions">Instructions<span></span></a></li>
<li><a href="assignment-1.html#hints">Hints<span></span></a></li>
</ul></li>
<li><a href="assignment-2.html#assignment-2">Assignment 2<span></span></a>
<ul>
<li><a href="assignment-2.html#problem-statement-1">Problem Statement<span></span></a></li>
<li><a href="assignment-2.html#learning-objectives">Learning Objectives<span></span></a></li>
<li><a href="assignment-2.html#skill-list">Skill List<span></span></a></li>
<li><a href="assignment-2.html#instructions-1">Instructions<span></span></a></li>
<li><a href="assignment-2.html#function-details">Function Details<span></span></a></li>
</ul></li>
<li><a href="assignment-3.html#assignment-3">Assignment 3<span></span></a>
<ul>
<li><a href="assignment-3.html#problem-statement-2">Problem Statement<span></span></a></li>
<li><a href="assignment-3.html#learning-objectives-1">Learning Objectives<span></span></a></li>
<li><a href="assignment-3.html#skill-list-1">Skill List<span></span></a></li>
<li><a href="assignment-3.html#background-on-microarrays">Background on Microarrays<span></span></a></li>
<li><a href="assignment-3.html#background-on-principal-component-analysis">Background on Principal Component Analysis<span></span></a></li>
<li><a href="assignment-3.html#marisa-et-al.-gene-expression-classification-of-colon-cancer-into-molecular-subtypes-characterization-validation-and-prognostic-value.-plos-medicine-may-2013.-pmid-23700391">Marisa et al. Gene Expression Classification of Colon Cancer into Molecular Subtypes: Characterization, Validation, and Prognostic Value. PLoS Medicine, May 2013. PMID: 23700391<span></span></a></li>
<li><a href="assignment-3.html#scaling-data-using-r-scale">Scaling data using R <code>scale()</code><span></span></a></li>
<li><a href="assignment-3.html#proportion-of-variance-explained">Proportion of variance explained<span></span></a></li>
<li><a href="assignment-3.html#plotting-and-visualization-of-pca">Plotting and visualization of PCA<span></span></a></li>
<li><a href="assignment-3.html#hierarchical-clustering-and-heatmaps">Hierarchical Clustering and Heatmaps<span></span></a></li>
<li><a href="assignment-3.html#references">References<span></span></a></li>
</ul></li>
<li><a href="assignment-4.html#assignment-4">Assignment 4<span></span></a>
<ul>
<li><a href="assignment-4.html#problem-statement-3">Problem Statement<span></span></a></li>
<li><a href="assignment-4.html#learning-objectives-2">Learning Objectives<span></span></a></li>
<li><a href="assignment-4.html#skill-list-2">Skill List<span></span></a></li>
<li><a href="assignment-4.html#instructions-2">Instructions<span></span></a></li>
<li><a href="assignment-4.html#deliverables">Deliverables<span></span></a></li>
<li><a href="assignment-4.html#function-details-1">Function Details<span></span></a></li>
<li><a href="assignment-4.html#hints-1">Hints<span></span></a></li>
</ul></li>
<li><a href="assignment-5.html#assignment-5">Assignment 5<span></span></a>
<ul>
<li><a href="assignment-5.html#problem-statement-4">Problem Statement<span></span></a></li>
<li><a href="assignment-5.html#learning-objectives-3">Learning Objectives<span></span></a></li>
<li><a href="assignment-5.html#skill-list-3">Skill List<span></span></a></li>
<li><a href="assignment-5.html#deseq2-background">DESeq2 Background<span></span></a></li>
<li><a href="assignment-5.html#generating-a-counts-matrix">Generating a counts matrix<span></span></a></li>
<li><a href="assignment-5.html#prefiltering-counts-matrix">Prefiltering Counts matrix<span></span></a></li>
<li><a href="assignment-5.html#median-of-ratios-normalization">Median-of-ratios normalization<span></span></a></li>
<li><a href="assignment-5.html#deseq2-preparation">DESeq2 preparation<span></span></a></li>
<li><a href="assignment-5.html#omeara-et-al.-transcriptional-reversion-of-cardiac-myocyte-fate-during-mammalian-cardiac-regeneration.-circ-res.-feb-2015.-pmid-25477501l">O’Meara et al. Transcriptional Reversion of Cardiac Myocyte Fate During Mammalian Cardiac Regeneration. Circ Res. Feb 2015. PMID: 25477501l<span></span></a></li>
<li><a href="assignment-5.html#reading-and-subsetting-the-data-from-verse_counts.tsv-and-sample_metadata.csv">1. Reading and subsetting the data from verse_counts.tsv and sample_metadata.csv<span></span></a></li>
<li><a href="assignment-5.html#running-deseq2">2. Running DESeq2<span></span></a></li>
<li><a href="assignment-5.html#annotating-results-to-construct-a-labeled-volcano-plot">3. Annotating results to construct a labeled volcano plot<span></span></a></li>
<li><a href="assignment-5.html#diagnostic-plot-of-the-raw-p-values-for-all-genes">4. Diagnostic plot of the raw p-values for all genes<span></span></a></li>
<li><a href="assignment-5.html#plotting-the-logfoldchanges-for-differentially-expressed-genes">5. Plotting the LogFoldChanges for differentially expressed genes<span></span></a></li>
<li><a href="assignment-5.html#the-choice-of-fdr-cutoff-depends-on-cost">The choice of FDR cutoff depends on cost<span></span></a></li>
<li><a href="assignment-5.html#plotting-the-normalized-counts-of-differentially-expressed-genes">6. Plotting the normalized counts of differentially expressed genes<span></span></a></li>
<li><a href="assignment-5.html#volcano-plot-to-visualize-differential-expression-results">7. Volcano Plot to visualize differential expression results<span></span></a></li>
<li><a href="assignment-5.html#running-fgsea-vignette">8. Running fgsea <span>vignette</span><span></span></a></li>
<li><a href="assignment-5.html#plotting-the-top-ten-positive-nes-and-top-ten-negative-nes-pathways">9. Plotting the top ten positive NES and top ten negative NES pathways<span></span></a></li>
<li><a href="assignment-5.html#references-1">References<span></span></a></li>
</ul></li>
<li><a href="assignment-6.html#assignment-6">Assignment 6<span></span></a>
<ul>
<li><a href="assignment-6.html#problem-statement-5">Problem Statement<span></span></a></li>
<li><a href="assignment-6.html#learning-objectives-4">Learning Objectives<span></span></a></li>
<li><a href="assignment-6.html#skill-list-4">Skill List<span></span></a></li>
<li><a href="assignment-6.html#instructions-3">Instructions<span></span></a></li>
<li><a href="assignment-6.html#function-details-2">Function Details<span></span></a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix<span></span></b></span></li>
<li class="chapter" data-level="A" data-path="class-outlines.html"><a href="class-outlines.html"><i class="fa fa-check"></i><b>A</b> Class Outlines<span></span></a>
<ul>
<li class="chapter" data-level="A.1" data-path="week-1.html"><a href="week-1.html"><i class="fa fa-check"></i><b>A.1</b> Week 1<span></span></a></li>
<li class="chapter" data-level="A.2" data-path="week-2.html"><a href="week-2.html"><i class="fa fa-check"></i><b>A.2</b> Week 2<span></span></a></li>
<li class="chapter" data-level="A.3" data-path="week-3.html"><a href="week-3.html"><i class="fa fa-check"></i><b>A.3</b> Week 3<span></span></a></li>
<li class="chapter" data-level="A.4" data-path="week-4.html"><a href="week-4.html"><i class="fa fa-check"></i><b>A.4</b> Week 4<span></span></a></li>
<li class="chapter" data-level="A.5" data-path="week-5.html"><a href="week-5.html"><i class="fa fa-check"></i><b>A.5</b> Week 5<span></span></a></li>
<li class="chapter" data-level="A.6" data-path="week-6.html"><a href="week-6.html"><i class="fa fa-check"></i><b>A.6</b> Week 6<span></span></a></li>
<li class="chapter" data-level="A.7" data-path="week-7.html"><a href="week-7.html"><i class="fa fa-check"></i><b>A.7</b> Week 7<span></span></a></li>
<li class="chapter" data-level="A.8" data-path="week-8.html"><a href="week-8.html"><i class="fa fa-check"></i><b>A.8</b> Week 8<span></span></a></li>
<li class="chapter" data-level="A.9" data-path="week-9.html"><a href="week-9.html"><i class="fa fa-check"></i><b>A.9</b> Week 9<span></span></a></li>
<li class="chapter" data-level="A.10" data-path="week-10.html"><a href="week-10.html"><i class="fa fa-check"></i><b>A.10</b> Week 10<span></span></a></li>
<li class="chapter" data-level="A.11" data-path="week-11.html"><a href="week-11.html"><i class="fa fa-check"></i><b>A.11</b> Week 11<span></span></a></li>
<li class="chapter" data-level="A.12" data-path="week-12.html"><a href="week-12.html"><i class="fa fa-check"></i><b>A.12</b> Week 12<span></span></a></li>
<li class="chapter" data-level="A.13" data-path="week-13.html"><a href="week-13.html"><i class="fa fa-check"></i><b>A.13</b> Week 13<span></span></a></li>
<li class="chapter" data-level="A.14" data-path="week-14---no-class-for-project-work.html"><a href="week-14---no-class-for-project-work.html"><i class="fa fa-check"></i><b>A.14</b> Week 14 - no class for project work<span></span></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BF591 - R for Biological Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-two-or-more-dimensions" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Plotting Two or More Dimensions<a href="plotting-two-or-more-dimensions.html#plotting-two-or-more-dimensions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Multi-dimensional plots allow relationships between different quantities to be
depicted visually. As mentioned in the [Elemental Perceptual Tasks] section,
this involves mapping data to visual elements using different encodings. The
plot types in this section are examples of these different approaches to
combining visual data encodings.</p>
<div id="scatter-plots" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Scatter Plots<a href="plotting-two-or-more-dimensions.html#scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Scatter plots visualize pairs of quantities, usually continuous, as points in
a two dimensional space. Most commonly, the points are plotted in <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_system">cartesian
coordinates</a>, but
<a href="https://en.wikipedia.org/wiki/Polar_coordinate_system">polar coordinates</a> or
other types of coordinate systems.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="plotting-two-or-more-dimensions.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau)) <span class="sc">+</span></span>
<span id="cb279-2"><a href="plotting-two-or-more-dimensions.html#cb279-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="main_files/viz%20dim%20scatter-1.png" width="672" /></p>
<p>The <code>geom_point()</code> geometry draws a shape, circle by default, at pixel
coordinates proportional to each <span class="math inline">\((x,y)\)</span> pair. The shape may be changed by
specifying the <code>shape=N</code> parameter to <code>geom_point</code>, where <code>N</code> is an integer ID
of the shape. The following plot shows which IDs correspond to which shapes:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="plotting-two-or-more-dimensions.html#cb280-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()</span>
<span id="cb280-2"><a href="plotting-two-or-more-dimensions.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb280-3"><a href="plotting-two-or-more-dimensions.html#cb280-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(y <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb280-4"><a href="plotting-two-or-more-dimensions.html#cb280-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">+</span>y<span class="sc">*</span><span class="dv">6</span> <span class="sc">&lt;</span> <span class="dv">26</span>) {</span>
<span id="cb280-5"><a href="plotting-two-or-more-dimensions.html#cb280-5" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="fu">tibble</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">shape=</span>x<span class="sc">+</span>y<span class="sc">*</span><span class="dv">6</span>,<span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb280-6"><a href="plotting-two-or-more-dimensions.html#cb280-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y<span class="fl">+0.5</span>,<span class="at">label=</span>label),<span class="fu">tibble</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">label=</span>x<span class="sc">+</span>y<span class="sc">*</span><span class="dv">6</span>))</span>
<span id="cb280-7"><a href="plotting-two-or-more-dimensions.html#cb280-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb280-8"><a href="plotting-two-or-more-dimensions.html#cb280-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb280-9"><a href="plotting-two-or-more-dimensions.html#cb280-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb280-10"><a href="plotting-two-or-more-dimensions.html#cb280-10" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="main_files/point%20shapes-1.png" width="672" /></p>
<p>However, <code>geom_points()</code> will choose up to six different shapes for you if you
map a categorical encoding to the <code>shape</code> aesthetic:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="plotting-two-or-more-dimensions.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">shape=</span>condition)) <span class="sc">+</span></span>
<span id="cb281-2"><a href="plotting-two-or-more-dimensions.html#cb281-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="main_files/scatter%20shape%20enc-1.png" width="672" />
Controlling which shapes are mapped to which value can be accomplished with
<a href="https://ggplot2.tidyverse.org/reference/scale_manual.html"><code>scale_shape_manual()</code></a>:</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="plotting-two-or-more-dimensions.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">shape=</span>condition)) <span class="sc">+</span></span>
<span id="cb282-2"><a href="plotting-two-or-more-dimensions.html#cb282-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb282-3"><a href="plotting-two-or-more-dimensions.html#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">9</span>))</span></code></pre></div>
<p><img src="main_files/scatter%20shape%20manual-1.png" width="672" /></p>
<p>Color encodings can also be added using either a continuous or discrete values:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="plotting-two-or-more-dimensions.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb283-2"><a href="plotting-two-or-more-dimensions.html#cb283-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ad_metadata)</span>
<span id="cb283-3"><a href="plotting-two-or-more-dimensions.html#cb283-3" aria-hidden="true" tabindex="-1"></a>g_condition <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">color=</span>condition),<span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb283-4"><a href="plotting-two-or-more-dimensions.html#cb283-4" aria-hidden="true" tabindex="-1"></a>g_age <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">color=</span>age_at_death),<span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb283-5"><a href="plotting-two-or-more-dimensions.html#cb283-5" aria-hidden="true" tabindex="-1"></a>g_condition <span class="sc">/</span> g_age</span></code></pre></div>
<p><img src="main_files/scatter%20color-1.png" width="672" /></p>
</div>
<div id="bubble-plots" class="section level3 hasAnchor" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Bubble Plots<a href="plotting-two-or-more-dimensions.html#bubble-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A close relative of the scatter plot is the bubble plot. A bubble plot is a
scatter plot where the area of the point markers is proportional to a third
continuous dimension. Consider the plot from above, with age at death encoded as
the area of each point:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="plotting-two-or-more-dimensions.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">size=</span>age_at_death)) <span class="sc">+</span></span>
<span id="cb284-2"><a href="plotting-two-or-more-dimensions.html#cb284-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="main_files/viz%20dim%20bubbl-1.png" width="672" />
In this example, the markers have been given 50% transparency, so overlapping
bubbles may be discerned more easily.</p>
<div class="box warning">
<p>Recall from the <a href="responsible-plotting.html#human-visual-perception">Human Visual Perception</a> section that it is difficult for
humans to accurately assess the relative sizes of shapes that are not near each
other. Bubble plots may be useful in some instances, but should be used
carefully.</p>
</div>
</div>
<div id="connected-scatter-plots" class="section level3 hasAnchor" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Connected Scatter Plots<a href="plotting-two-or-more-dimensions.html#connected-scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another close relative of the scatter plot is the connected scatter plot. A
connected scatter plot is simply a scatter plot where certain pairs of points
are connected with a line in addition to the markers. Any pairs of points may
have lines connecting them, but most often the line indicates some dimension of
time, i.e. two points that are sequential in time are connected. Below is a
connected scatter plot with a line drawn from the youngest to oldest age at
death:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="plotting-two-or-more-dimensions.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(ad_metadata,age_at_death) <span class="sc">%&gt;%</span></span>
<span id="cb285-2"><a href="plotting-two-or-more-dimensions.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb285-3"><a href="plotting-two-or-more-dimensions.html#cb285-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>abeta,</span>
<span id="cb285-4"><a href="plotting-two-or-more-dimensions.html#cb285-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend=</span><span class="fu">lag</span>(x,<span class="dv">1</span>),</span>
<span id="cb285-5"><a href="plotting-two-or-more-dimensions.html#cb285-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>tau,</span>
<span id="cb285-6"><a href="plotting-two-or-more-dimensions.html#cb285-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend=</span><span class="fu">lag</span>(y,<span class="dv">1</span>)</span>
<span id="cb285-7"><a href="plotting-two-or-more-dimensions.html#cb285-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb285-8"><a href="plotting-two-or-more-dimensions.html#cb285-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb285-9"><a href="plotting-two-or-more-dimensions.html#cb285-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">xend=</span>xend, <span class="at">y=</span>tau, <span class="at">yend=</span>yend)) <span class="sc">+</span></span>
<span id="cb285-10"><a href="plotting-two-or-more-dimensions.html#cb285-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">shape=</span>condition,<span class="at">color=</span>condition),<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="main_files/viz%20connected%20scatter-1.png" width="672" /></p>
<p>The plot suggests that perhaps the AD and Control samples might be closer in age
within groups than between. We can confirm this using another type of plot, e.g.
density grouped by condition.</p>
</div>
<div id="line-plots" class="section level3 hasAnchor" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Line Plots<a href="plotting-two-or-more-dimensions.html#line-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Line plots connect pairs of points with a line without drawing a symbol at each
point. The <code>geom_line()</code> function will draw lines between pairs of points sorted
by <span class="math inline">\(x\)</span> axis by default:</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="plotting-two-or-more-dimensions.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau)) <span class="sc">+</span></span>
<span id="cb286-2"><a href="plotting-two-or-more-dimensions.html#cb286-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="main_files/unnamed-chunk-109-1.png" width="672" /></p>
<p>This may be useful when plotting multiple lines using the <code>group</code> aesthetic
mapping:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="plotting-two-or-more-dimensions.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(ad_metadata,</span>
<span id="cb287-2"><a href="plotting-two-or-more-dimensions.html#cb287-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(tau,abeta,iba1,gfap),</span>
<span id="cb287-3"><a href="plotting-two-or-more-dimensions.html#cb287-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">&#39;Marker&#39;</span>,</span>
<span id="cb287-4"><a href="plotting-two-or-more-dimensions.html#cb287-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">&#39;Intensity&#39;</span></span>
<span id="cb287-5"><a href="plotting-two-or-more-dimensions.html#cb287-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb287-6"><a href="plotting-two-or-more-dimensions.html#cb287-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>ID, <span class="at">y=</span>Intensity, <span class="at">group=</span>Marker, <span class="at">color=</span>Marker)) <span class="sc">+</span></span>
<span id="cb287-7"><a href="plotting-two-or-more-dimensions.html#cb287-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="main_files/unnamed-chunk-110-1.png" width="672" /></p>
<p>This plot is similar to a <a href="parallel-coordinate-plots">parallel coordinate plot</a>,
in that all four dimensions of each sample are displayed using a position
encoding.</p>
</div>
<div id="parallel-coordinate-plots-1" class="section level3 hasAnchor" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Parallel Coordinate Plots<a href="plotting-two-or-more-dimensions.html#parallel-coordinate-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Parallel coordinate plots are line plots where each of possibly many continuous
variables are given vertical position encodings and each sample has its own
line. Unlike the line plot above, each vertical axis can have a different scale,
thus allowing plots of variables with very different value ranges. The following
is a parallel coordinate plot of our AD metadata:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="plotting-two-or-more-dimensions.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb288-2"><a href="plotting-two-or-more-dimensions.html#cb288-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-3"><a href="plotting-two-or-more-dimensions.html#cb288-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(ad_metadata,</span>
<span id="cb288-4"><a href="plotting-two-or-more-dimensions.html#cb288-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb288-5"><a href="plotting-two-or-more-dimensions.html#cb288-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn=</span><span class="dv">3</span>,</span>
<span id="cb288-6"><a href="plotting-two-or-more-dimensions.html#cb288-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">showPoints=</span><span class="cn">TRUE</span></span>
<span id="cb288-7"><a href="plotting-two-or-more-dimensions.html#cb288-7" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">+</span></span>
<span id="cb288-8"><a href="plotting-two-or-more-dimensions.html#cb288-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#bbbbbb&quot;</span>, <span class="st">&quot;#666666&quot;</span>))</span></code></pre></div>
<p><img src="main_files/viz%20pcp%20ad-1.png" width="672" /></p>
<p>All the variables have been scaled and centered to have mean zero and standard
deviation 1, and the values plotted using a position encoding vertically long
each. Each line is a different subject, and have been colored based on the type
of subject, either AD or control. This encoding allows us to make a number of
observations about the samples, e.g. except for gfap, AD samples have
consistently higher values than Controls.</p>
<div class="box note">
<p>A common way to specify colors is with a six digit
<a href="https://en.wikipedia.org/wiki/Hexadecimal">hexadecimal</a> code, e.g. <code>#2ca9f3</code>.
These codes form a triplet of (<code>rr</code>,<code>gg</code>,<code>bb</code>), where <code>rr</code> is the value of the
color red, <code>gg</code> the value of green, and <code>bb</code> for blue, examples:</p>
<ul>
<li><code>#000000</code> is the color black, or a value of zero in all three colors</li>
<li><code>#ffffff</code> is the color white, with maximum value for all three colors</li>
<li><code>#ff0000</code> is the color red, with full red value and no value for green or blue</li>
<li><code>#0000ff</code> is the color blue, with full blue value and no value for red or green</li>
<li><code>#2ca9f3</code> is <span style="color: #2ca9f3">this color</span>, a combination of red, green, and blue</li>
</ul>
<p>All colors in tidyverse may be specified with these hexadecimal color codes. See
<a href="https://en.wikipedia.org/wiki/Web_colors">web colors</a> for more information on
how to specify colors in this way.</p>
</div>
</div>
<div id="heatmaps" class="section level3 hasAnchor" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> Heatmaps<a href="plotting-two-or-more-dimensions.html#heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Heatmaps visualize values associated with a grid of points <span class="math inline">\((x,y,z)\)</span> as a grid
of colored rectangles, where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> define the grid point coordinates and
<span class="math inline">\(z\)</span> is a continuous value. A common heatmap you might have seen is the <a href="https://en.wikipedia.org/wiki/Weather_map">weather
map</a>, which plots current or
predicted weather patterns on top of a geographic map:</p>
<div class="figure">
<img src="weather_map.png" alt="" />
<p class="caption">Weather maps are heatmaps</p>
</div>
<p>The color at each grid coordinate, which in this case are spaced closely enough
so we cannot distinguish the boundaries between the rectangles without zooming
in, is proportional to the type and intensity of weather at that location.
In the weather map, the weather values are mapped to a <em>color scales</em> that
describe the amount of precipitation as shown in the map legend.</p>
<p>In biology, heatmaps are more typically used to visualize matrices. The concept
is the same as with the weather map, except instead of geographic coordinates
the grid corresponds to the rows and columns of a data matrix, and the color of
each grid point is mapped to a color scale chosen by the designer. The grid of
rectangles is typically not overlayed over anything, as in the weather map, but
is instead the entire visualization.</p>
<p>We can create heatmap in R using the base R
<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/heatmap"><code>heatmap()</code></a>
function. Below is a heatmap visualization of our histological markers from the
AD example:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="plotting-two-or-more-dimensions.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># heatmap() requires a R matrix, and cannot accept a tibble or a dataframe</span></span>
<span id="cb289-2"><a href="plotting-two-or-more-dimensions.html#cb289-2" aria-hidden="true" tabindex="-1"></a>marker_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(</span>
<span id="cb289-3"><a href="plotting-two-or-more-dimensions.html#cb289-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ad_metadata,<span class="fu">c</span>(tau,abeta,iba1,gfap))</span>
<span id="cb289-4"><a href="plotting-two-or-more-dimensions.html#cb289-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb289-5"><a href="plotting-two-or-more-dimensions.html#cb289-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rownames of the matrix become y labels</span></span>
<span id="cb289-6"><a href="plotting-two-or-more-dimensions.html#cb289-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(marker_matrix) <span class="ot">&lt;-</span> ad_metadata<span class="sc">$</span>ID</span>
<span id="cb289-7"><a href="plotting-two-or-more-dimensions.html#cb289-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb289-8"><a href="plotting-two-or-more-dimensions.html#cb289-8" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(marker_matrix)</span></code></pre></div>
<p><img src="main_files/data%20viz%20marker%20heatmap-1.png" width="672" /></p>
<p>The lower right portion of the plot is the heatmap, where the matrix values are
visualized on a color gradient from light yellow to dark red.</p>
<p>More precisely, the <code>heatmap()</code> function creates a <em>clustered heatmap</em>, where
the rows and columns have been <a href="exploratory-data-analysis.html#hierarchical-clustering">hierarchically
clustered</a> separately and ordered according to how
similar they are to one another. The left and top line diagrams are
<a href="other-kind-of-plots.html#dendrograms">dendrograms</a>, which depict the similarity between rows and
columns as a tree, where the total branch length summed from one row/column to
another is proportional to the dissimilarity (i.e. numeric distance) of the two.</p>
<div class="box note">
<p>The base R <code>heatmap()</code> function performs many different operations on the input
matrix than just draw a grid of rectangles in proportion to the values. By
default, it also:</p>
<ul>
<li>performs <a href="exploratory-data-analysis.html#hierarchical-clustering">hierarchical clustering</a> of the rows and
columns using a Euclidean distance function and orders them accordingly</li>
<li>draws <a href="#dendrogram">dendrograms</a> on the rows and columns according to the
clustering</li>
<li>scales the data in the rows to have mean zero and standard deviation 1</li>
</ul>
<p>Each of these defaults can be changed by passing arguments into the function
call. The following turns off all of the extra functionality and produces only a
heatmap of the matrix:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="plotting-two-or-more-dimensions.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb290-2"><a href="plotting-two-or-more-dimensions.html#cb290-2" aria-hidden="true" tabindex="-1"></a>  marker_matrix,</span>
<span id="cb290-3"><a href="plotting-two-or-more-dimensions.html#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rowv=</span><span class="cn">NA</span>,</span>
<span id="cb290-4"><a href="plotting-two-or-more-dimensions.html#cb290-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb290-5"><a href="plotting-two-or-more-dimensions.html#cb290-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb290-6"><a href="plotting-two-or-more-dimensions.html#cb290-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="main_files/data%20viz%20pure%20heatmap-1.png" width="672" />
Note how the colors in this heatmap are very different for many of the
marker/sample pairs. This illustrates some of the dangers of using heatmaps,
which are described more fully in the <a href="plotting-two-or-more-dimensions.html#how-to-use-heatmaps-responsibly">How To Use Heatmaps Responsibly</a> section
below.</p>
</div>
<p>The base R heatmap function has the major drawback that no color key is provided
to indicate how values map to colors. Another heatmap
<a href="https://www.rdocumentation.org/packages/gplots/versions/3.1.1/topics/heatmap.2"><code>heatmap.2</code></a>
function in the <a href="https://cran.r-project.org/web/packages/gplots/index.html"><code>gplots</code> package</a>
which has a similar interface to <code>heatmap()</code>, but allows provides more
parameters to control the behavior of the plot and includes a color key:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="plotting-two-or-more-dimensions.html#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb291-2"><a href="plotting-two-or-more-dimensions.html#cb291-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(marker_matrix)</span></code></pre></div>
<p><img src="main_files/heatmap.2-1.png" width="672" /></p>
<p>The extra decoration (dashed and solid vertical lines called <em>traces</em> by the
package) provide another way to understand the magnitude of the value in each
cell. Refer to the <a href="https://www.rdocumentation.org/packages/gplots/versions/3.1.1/topics/heatmap.2"><code>gplots</code> documentation of
<code>heatmap2</code></a>
for more information on how to interpret the trace (hint: you may turn it off
with by passing the argument <code>trace = "none"</code> to the function call).</p>
<p>Both <code>heatmap()</code> and <code>heatmap.2()</code> provide a useful method to annotate rows and
columns with a categorical variable. Each of our subjects either has AD or is a
control, and we can add a color bar along the margin of the plot to indicate the
status of each subject:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="plotting-two-or-more-dimensions.html#cb292-1" aria-hidden="true" tabindex="-1"></a>condition_colors <span class="ot">&lt;-</span></span>
<span id="cb292-2"><a href="plotting-two-or-more-dimensions.html#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb292-3"><a href="plotting-two-or-more-dimensions.html#cb292-3" aria-hidden="true" tabindex="-1"></a>    ad_metadata,</span>
<span id="cb292-4"><a href="plotting-two-or-more-dimensions.html#cb292-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="fu">if_else</span>(condition <span class="sc">==</span> <span class="st">&quot;AD&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>)</span>
<span id="cb292-5"><a href="plotting-two-or-more-dimensions.html#cb292-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb292-6"><a href="plotting-two-or-more-dimensions.html#cb292-6" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb292-7"><a href="plotting-two-or-more-dimensions.html#cb292-7" aria-hidden="true" tabindex="-1"></a>  marker_matrix,</span>
<span id="cb292-8"><a href="plotting-two-or-more-dimensions.html#cb292-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">RowSideColors=</span>condition_colors<span class="sc">$</span>color</span>
<span id="cb292-9"><a href="plotting-two-or-more-dimensions.html#cb292-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="main_files/heatmap%20margin-1.png" width="672" /></p>
<p>And with <code>heatmap.2</code>:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="plotting-two-or-more-dimensions.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(</span>
<span id="cb293-2"><a href="plotting-two-or-more-dimensions.html#cb293-2" aria-hidden="true" tabindex="-1"></a>  marker_matrix,</span>
<span id="cb293-3"><a href="plotting-two-or-more-dimensions.html#cb293-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">RowSideColors=</span>condition_colors<span class="sc">$</span>color</span>
<span id="cb293-4"><a href="plotting-two-or-more-dimensions.html#cb293-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="main_files/heatmap.2%20margin-1.png" width="672" /></p>
<p>Heatmaps may also be created using ggplot and the
<a href="https://ggplot2.tidyverse.org/reference/geom_tile.html"><code>geom_tile</code></a> geometry.
This method of generating heatmaps is more “manual” than the other functions
covered so far, and so are both flexible and require more work to obtain certain
functionality (e.g. clustering, color bars on side margins, etc). This geometry
requires the data to be in long format, with one column for <code>x</code>, <code>y</code>, and <code>z</code>
values:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="plotting-two-or-more-dimensions.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(</span>
<span id="cb294-2"><a href="plotting-two-or-more-dimensions.html#cb294-2" aria-hidden="true" tabindex="-1"></a>  ad_metadata,</span>
<span id="cb294-3"><a href="plotting-two-or-more-dimensions.html#cb294-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(tau,abeta,iba1,gfap),</span>
<span id="cb294-4"><a href="plotting-two-or-more-dimensions.html#cb294-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">&quot;Marker&quot;</span>,</span>
<span id="cb294-5"><a href="plotting-two-or-more-dimensions.html#cb294-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">&quot;Intensity&quot;</span></span>
<span id="cb294-6"><a href="plotting-two-or-more-dimensions.html#cb294-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb294-7"><a href="plotting-two-or-more-dimensions.html#cb294-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Marker,<span class="at">y=</span>ID,<span class="at">fill=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb294-8"><a href="plotting-two-or-more-dimensions.html#cb294-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/heatmap%20geom%20tile-1.png" width="672" /></p>
<p>Note this ggplot method does not scale or reorder rows or columns.</p>
<div id="specifying-heatmap-colors" class="section level4 hasAnchor" number="7.5.6.1">
<h4><span class="header-section-number">7.5.6.1</span> Specifying Heatmap Colors<a href="plotting-two-or-more-dimensions.html#specifying-heatmap-colors" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The colors of the heatmap may be changed by passing one of the <a href="https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/palettes.html">native color
palettes</a>
to the heatmap function with the <code>col</code> argument:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="plotting-two-or-more-dimensions.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># native R colors are:</span></span>
<span id="cb295-2"><a href="plotting-two-or-more-dimensions.html#cb295-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - rainbow(n, start=.7, end=.1)</span></span>
<span id="cb295-3"><a href="plotting-two-or-more-dimensions.html#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - heat.colors(n)</span></span>
<span id="cb295-4"><a href="plotting-two-or-more-dimensions.html#cb295-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - terrain.colors(n)</span></span>
<span id="cb295-5"><a href="plotting-two-or-more-dimensions.html#cb295-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - topo.colors(n)</span></span>
<span id="cb295-6"><a href="plotting-two-or-more-dimensions.html#cb295-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - cm.colors(n)</span></span>
<span id="cb295-7"><a href="plotting-two-or-more-dimensions.html#cb295-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the n argument specifies the number of colors (i.e. resolution) of the colormap to return</span></span>
<span id="cb295-8"><a href="plotting-two-or-more-dimensions.html#cb295-8" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(marker_matrix,<span class="at">col=</span><span class="fu">cm.colors</span>(<span class="dv">256</span>))</span></code></pre></div>
<p><img src="main_files/heatmap%20cm%20colors-1.png" width="672" /></p>
<p>To change the color using ggplot and <code>geom_tile()</code>, use the
<a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html"><code>scale_fill_gradientn</code></a>
function to specify a different color palette:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="plotting-two-or-more-dimensions.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(</span>
<span id="cb296-2"><a href="plotting-two-or-more-dimensions.html#cb296-2" aria-hidden="true" tabindex="-1"></a>  ad_metadata,</span>
<span id="cb296-3"><a href="plotting-two-or-more-dimensions.html#cb296-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(tau,abeta,iba1,gfap),</span>
<span id="cb296-4"><a href="plotting-two-or-more-dimensions.html#cb296-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">&quot;Marker&quot;</span>,</span>
<span id="cb296-5"><a href="plotting-two-or-more-dimensions.html#cb296-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">&quot;Intensity&quot;</span></span>
<span id="cb296-6"><a href="plotting-two-or-more-dimensions.html#cb296-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb296-7"><a href="plotting-two-or-more-dimensions.html#cb296-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Marker,<span class="at">y=</span>ID,<span class="at">fill=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb296-8"><a href="plotting-two-or-more-dimensions.html#cb296-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb296-9"><a href="plotting-two-or-more-dimensions.html#cb296-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span><span class="fu">cm.colors</span>(<span class="dv">256</span>))</span></code></pre></div>
<p><img src="main_files/heatmap%20geom%20tile%20color%20change-1.png" width="672" />
The native color palettes in R look as follows:</p>
<p><img src="main_files/data%20viz%20heatmap%20native%20palettes-1.png" width="672" /></p>
<p>Instead of these color palettes, you may use one of the
<a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">ColorBrewer</a>
palettes in the <a href="https://cran.r-project.org/web/packages/RColorBrewer/index.html">RColorBrewer
package</a></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="plotting-two-or-more-dimensions.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb297-2"><a href="plotting-two-or-more-dimensions.html#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="main_files/heatmap%20colorbrewer%20palettes-1.png" width="672" /></p>
<p>There are very many color palettes to choose from, and you may also create your
own palettes. Creating color palettes is <a href="https://www.r-bloggers.com/2016/07/creating-color-palettes-in-r/">somewhat
complicated</a>
in base R, but <code>ggplot()</code> provides <a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">convenient
functions</a>
<code>scale_fill_gradient()</code> and <code>scale_fill_gradient2()</code> to produce gradient scales
with 2 or 3 colors, respectively. More discussion on how to choose colors is
described in the next section.</p>
</div>
</div>
<div id="how-to-use-heatmaps-responsibly" class="section level3 hasAnchor" number="7.5.7">
<h3><span class="header-section-number">7.5.7</span> How To Use Heatmaps Responsibly<a href="plotting-two-or-more-dimensions.html#how-to-use-heatmaps-responsibly" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While heatmaps may seem intuitive, they are actually quite complicated and can
be difficult to create in a way that accurately depicts the underlying matrix.
As described in the <a href="responsible-plotting.html#human-visual-perception">Human Visual Perception</a> section, our visual system
estimates the hue and value of colors based on adjacent colors. For large
heatmaps with many rows and columns, it is therefore very difficult to
accurately estimate relationships across wide sections of the heatmap. This may
not always be problematic, as heatmaps might only be needed to convey general
patterns in a dataset. However, the designer has a large degree of control over
how the heatmap utilizes hue and value when mapping to the underlying numbers,
and those choices have a large impact on the interpretation of the chart. Before
data can be effectively visualized in a heatmap, some preprocessing is usually
required to yield a useful plot.</p>
<p>There are four major factors that influence how a dataset can be visualized as
a heatmap:</p>
<ol style="list-style-type: decimal">
<li>The type of features, i.e. whether the features are continuous or discrete</li>
<li>The relative scales of the features</li>
<li>The total range of the data</li>
<li>Whether or not the data are centered</li>
</ol>
<div id="the-type-of-the-features" class="section level4 hasAnchor" number="7.5.7.1">
<h4><span class="header-section-number">7.5.7.1</span> The Type of the Features<a href="plotting-two-or-more-dimensions.html#the-type-of-the-features" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are two broad types of features: discrete and continuous. The data
elements of a discrete feature take on one of a finite set of values. For
example, a discrete feature might include values like 0 and 1, <code>Case</code> and
<code>Control</code> or only the integers between 1 and 6. In general, we are primarily
interested to know whether samples with the same discrete value group together,
so ideally all colors that are mapped to discrete features will be easily
distinguishable from one another. As the number of possible values the feature
may take increases, finding a set of colors that are all distinguishable from
one another becomes increasingly difficult. Consider the following three
heatmaps that show different discrete data:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="plotting-two-or-more-dimensions.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb298-2"><a href="plotting-two-or-more-dimensions.html#cb298-2" aria-hidden="true" tabindex="-1"></a>random_letters <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb298-3"><a href="plotting-two-or-more-dimensions.html#cb298-3" aria-hidden="true" tabindex="-1"></a>  letters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>,<span class="st">&#39;E&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;G&#39;</span>,<span class="st">&#39;H&#39;</span>,<span class="st">&#39;I&#39;</span>,<span class="st">&#39;J&#39;</span>)</span>
<span id="cb298-4"><a href="plotting-two-or-more-dimensions.html#cb298-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span>n],<span class="dv">10</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb298-5"><a href="plotting-two-or-more-dimensions.html#cb298-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb298-6"><a href="plotting-two-or-more-dimensions.html#cb298-6" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>))</span>
<span id="cb298-7"><a href="plotting-two-or-more-dimensions.html#cb298-7" aria-hidden="true" tabindex="-1"></a>g_binary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb298-8"><a href="plotting-two-or-more-dimensions.html#cb298-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature=</span>features,</span>
<span id="cb298-9"><a href="plotting-two-or-more-dimensions.html#cb298-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">random_letters</span>(<span class="dv">2</span>),</span>
<span id="cb298-10"><a href="plotting-two-or-more-dimensions.html#cb298-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">random_letters</span>(<span class="dv">2</span>),</span>
<span id="cb298-11"><a href="plotting-two-or-more-dimensions.html#cb298-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">random_letters</span>(<span class="dv">2</span>)</span>
<span id="cb298-12"><a href="plotting-two-or-more-dimensions.html#cb298-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb298-13"><a href="plotting-two-or-more-dimensions.html#cb298-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))  <span class="sc">%&gt;%</span></span>
<span id="cb298-14"><a href="plotting-two-or-more-dimensions.html#cb298-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>feature,<span class="at">fill=</span>value)) <span class="sc">+</span> <span class="fu">geom_tile</span>()</span>
<span id="cb298-15"><a href="plotting-two-or-more-dimensions.html#cb298-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb298-16"><a href="plotting-two-or-more-dimensions.html#cb298-16" aria-hidden="true" tabindex="-1"></a>g_trinary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb298-17"><a href="plotting-two-or-more-dimensions.html#cb298-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb298-18"><a href="plotting-two-or-more-dimensions.html#cb298-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">random_letters</span>(<span class="dv">3</span>),</span>
<span id="cb298-19"><a href="plotting-two-or-more-dimensions.html#cb298-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">random_letters</span>(<span class="dv">3</span>),</span>
<span id="cb298-20"><a href="plotting-two-or-more-dimensions.html#cb298-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">random_letters</span>(<span class="dv">3</span>)</span>
<span id="cb298-21"><a href="plotting-two-or-more-dimensions.html#cb298-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb298-22"><a href="plotting-two-or-more-dimensions.html#cb298-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))  <span class="sc">%&gt;%</span></span>
<span id="cb298-23"><a href="plotting-two-or-more-dimensions.html#cb298-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>feature,<span class="at">fill=</span>value)) <span class="sc">+</span> <span class="fu">geom_tile</span>()</span>
<span id="cb298-24"><a href="plotting-two-or-more-dimensions.html#cb298-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-25"><a href="plotting-two-or-more-dimensions.html#cb298-25" aria-hidden="true" tabindex="-1"></a>g_unmanageable <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb298-26"><a href="plotting-two-or-more-dimensions.html#cb298-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb298-27"><a href="plotting-two-or-more-dimensions.html#cb298-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">random_letters</span>(<span class="dv">10</span>),</span>
<span id="cb298-28"><a href="plotting-two-or-more-dimensions.html#cb298-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">random_letters</span>(<span class="dv">10</span>),</span>
<span id="cb298-29"><a href="plotting-two-or-more-dimensions.html#cb298-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">random_letters</span>(<span class="dv">10</span>)</span>
<span id="cb298-30"><a href="plotting-two-or-more-dimensions.html#cb298-30" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb298-31"><a href="plotting-two-or-more-dimensions.html#cb298-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))  <span class="sc">%&gt;%</span></span>
<span id="cb298-32"><a href="plotting-two-or-more-dimensions.html#cb298-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>feature,<span class="at">fill=</span>value)) <span class="sc">+</span> <span class="fu">geom_tile</span>()</span>
<span id="cb298-33"><a href="plotting-two-or-more-dimensions.html#cb298-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-34"><a href="plotting-two-or-more-dimensions.html#cb298-34" aria-hidden="true" tabindex="-1"></a>g_binary <span class="sc">|</span> g_trinary <span class="sc">|</span> g_unmanageable</span></code></pre></div>
<p><img src="main_files/viz%20discrete%20heatmap-1.png" width="672" /></p>
<p>The first and second heatmaps have 2 and 3 discrete values each, and the colors
are easy to tell apart. The third heatmap has 10 discrete values and it is very
difficult to distinguish between colors in different parts of the plot.</p>
<p>Continuous features can take any of a (possibly infinite) range of real values,
e.g. <span class="math inline">\(-3.252\)</span>, <span class="math inline">\(858,352\)</span>, or <span class="math inline">\(0\)</span>. These values will be mapped to colors of a
<em>gradient</em>, where two or more colors are blended together linearly from one
color to another, and values are mapped within this range of colors in
proportion to their relative magnitudes. Two gradients, one with two colors and
one with three, are shown below:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="plotting-two-or-more-dimensions.html#cb299-1" aria-hidden="true" tabindex="-1"></a>g_two_up <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb299-2"><a href="plotting-two-or-more-dimensions.html#cb299-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="st">&#39;a&#39;</span>,</span>
<span id="cb299-3"><a href="plotting-two-or-more-dimensions.html#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb299-4"><a href="plotting-two-or-more-dimensions.html#cb299-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">val=</span>x</span>
<span id="cb299-5"><a href="plotting-two-or-more-dimensions.html#cb299-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb299-6"><a href="plotting-two-or-more-dimensions.html#cb299-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>ID,<span class="at">fill=</span>val)) <span class="sc">+</span></span>
<span id="cb299-7"><a href="plotting-two-or-more-dimensions.html#cb299-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb299-8"><a href="plotting-two-or-more-dimensions.html#cb299-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">high=</span><span class="st">&quot;#ffdddd&quot;</span>)</span>
<span id="cb299-9"><a href="plotting-two-or-more-dimensions.html#cb299-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-10"><a href="plotting-two-or-more-dimensions.html#cb299-10" aria-hidden="true" tabindex="-1"></a>g_two_down <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb299-11"><a href="plotting-two-or-more-dimensions.html#cb299-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="st">&#39;a&#39;</span>,</span>
<span id="cb299-12"><a href="plotting-two-or-more-dimensions.html#cb299-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb299-13"><a href="plotting-two-or-more-dimensions.html#cb299-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">val=</span>x</span>
<span id="cb299-14"><a href="plotting-two-or-more-dimensions.html#cb299-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb299-15"><a href="plotting-two-or-more-dimensions.html#cb299-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>ID,<span class="at">fill=</span>val)) <span class="sc">+</span></span>
<span id="cb299-16"><a href="plotting-two-or-more-dimensions.html#cb299-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb299-17"><a href="plotting-two-or-more-dimensions.html#cb299-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#ffdddd&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>)</span>
<span id="cb299-18"><a href="plotting-two-or-more-dimensions.html#cb299-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-19"><a href="plotting-two-or-more-dimensions.html#cb299-19" aria-hidden="true" tabindex="-1"></a>g_three <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb299-20"><a href="plotting-two-or-more-dimensions.html#cb299-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="st">&#39;a&#39;</span>,</span>
<span id="cb299-21"><a href="plotting-two-or-more-dimensions.html#cb299-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb299-22"><a href="plotting-two-or-more-dimensions.html#cb299-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">val=</span>x</span>
<span id="cb299-23"><a href="plotting-two-or-more-dimensions.html#cb299-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb299-24"><a href="plotting-two-or-more-dimensions.html#cb299-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>ID,<span class="at">fill=</span>val)) <span class="sc">+</span></span>
<span id="cb299-25"><a href="plotting-two-or-more-dimensions.html#cb299-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb299-26"><a href="plotting-two-or-more-dimensions.html#cb299-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#9999ff&quot;</span>, <span class="at">midpoint=</span><span class="fl">0.5</span>)</span>
<span id="cb299-27"><a href="plotting-two-or-more-dimensions.html#cb299-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-28"><a href="plotting-two-or-more-dimensions.html#cb299-28" aria-hidden="true" tabindex="-1"></a>g_two_up <span class="sc">/</span> g_two_down <span class="sc">/</span> g_three</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20continuous-1.png" width="672" /></p>
<p>These three example gradients comprise the most common types of color mappings.
The first two with one color differ in which color (i.e. lighter or darker) is
mapped to the largest value. The third gradient is called a <em>diverging</em> palette,
because the maximum and minimum values show divergence from some central value,
which in this case is 0.5. For diverging color palettes,
the value in the middle of the gradient is often very important, as it defines
which values are visualized in which color. More on diverging color palettes is
in the following sections.</p>
<p>In general, the types of features, i.e. discrete or continuous, must all be the
same for a heatmap to be meaningful. Once this has been determined, the values
of each feature must be examined and possibly transformed, as described next.</p>
</div>
<div id="scales-of-features" class="section level4 hasAnchor" number="7.5.7.2">
<h4><span class="header-section-number">7.5.7.2</span> Scales of Features<a href="plotting-two-or-more-dimensions.html#scales-of-features" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The second important consideration when plotting a heatmap is to understand the
nature of the different features and how they relate to one another.
Specifically, the features must all be on a comparable scale, or transformed
appropriately to attain this, for the colors in the heatmap to be visible.
Consider the following heatmap with three features plotted as columns and 10
samples as rows:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="plotting-two-or-more-dimensions.html#cb300-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb300-2"><a href="plotting-two-or-more-dimensions.html#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb300-3"><a href="plotting-two-or-more-dimensions.html#cb300-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb300-4"><a href="plotting-two-or-more-dimensions.html#cb300-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">20</span>),</span>
<span id="cb300-5"><a href="plotting-two-or-more-dimensions.html#cb300-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">5</span>)</span>
<span id="cb300-6"><a href="plotting-two-or-more-dimensions.html#cb300-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb300-7"><a href="plotting-two-or-more-dimensions.html#cb300-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))</span>
<span id="cb300-8"><a href="plotting-two-or-more-dimensions.html#cb300-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-9"><a href="plotting-two-or-more-dimensions.html#cb300-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb300-10"><a href="plotting-two-or-more-dimensions.html#cb300-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20mismatch%20scale-1.png" width="672" /></p>
<p>The scales of the different features <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> are different, namely
they have means of 0, 100, and 20, respectively. This an be clearly seen when
the data are plotted as a <a href="beeswarm-plots">beeswarm plot</a>:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="plotting-two-or-more-dimensions.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb301-2"><a href="plotting-two-or-more-dimensions.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb301-3"><a href="plotting-two-or-more-dimensions.html#cb301-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>value,<span class="at">color=</span>name))</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20violin-1.png" width="672" /></p>
<p>As the data are on dramatically different scales, only the feature with the
largest spread (b) can be distinguished in the heatmap.</p>
<p>In order to visualize all these data meaningfully in the same plot, the features
must be <em>scaled</em> so they are all comparable. Typically this is done by
standardizing the features to have a mean of zero and a standard deviation of 1:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="plotting-two-or-more-dimensions.html#cb302-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb302-2"><a href="plotting-two-or-more-dimensions.html#cb302-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span><span class="st">&#39;ID&#39;</span>,<span class="at">names_from=</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb302-3"><a href="plotting-two-or-more-dimensions.html#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb302-4"><a href="plotting-two-or-more-dimensions.html#cb302-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(a,b,c),scale)</span>
<span id="cb302-5"><a href="plotting-two-or-more-dimensions.html#cb302-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb302-6"><a href="plotting-two-or-more-dimensions.html#cb302-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb302-7"><a href="plotting-two-or-more-dimensions.html#cb302-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb302-8"><a href="plotting-two-or-more-dimensions.html#cb302-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20standard-1.png" width="672" />
Now each feature has a mean of zero and standard deviation of one:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="plotting-two-or-more-dimensions.html#cb303-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb303-2"><a href="plotting-two-or-more-dimensions.html#cb303-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span><span class="st">&#39;ID&#39;</span>,<span class="at">names_from=</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb303-3"><a href="plotting-two-or-more-dimensions.html#cb303-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb303-4"><a href="plotting-two-or-more-dimensions.html#cb303-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(a,b,c),scale)</span>
<span id="cb303-5"><a href="plotting-two-or-more-dimensions.html#cb303-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb303-6"><a href="plotting-two-or-more-dimensions.html#cb303-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb303-7"><a href="plotting-two-or-more-dimensions.html#cb303-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb303-8"><a href="plotting-two-or-more-dimensions.html#cb303-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>value,<span class="at">color=</span>name))</span></code></pre></div>
<p><img src="main_files/viz%20standard%20violin-1.png" width="672" /></p>
<p>Now that the data are all on the same scale, each is mapped across the full
range of the color palette. In this case, we explicitly scaled each feature, but
it is possible to scale by each sample as well:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="plotting-two-or-more-dimensions.html#cb304-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb304-2"><a href="plotting-two-or-more-dimensions.html#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span>name,<span class="at">names_from=</span>ID) <span class="sc">%&gt;%</span></span>
<span id="cb304-3"><a href="plotting-two-or-more-dimensions.html#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb304-4"><a href="plotting-two-or-more-dimensions.html#cb304-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&#39;F&#39;</span>),scale)</span>
<span id="cb304-5"><a href="plotting-two-or-more-dimensions.html#cb304-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb304-6"><a href="plotting-two-or-more-dimensions.html#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">&#39;F&#39;</span>),<span class="at">names_to=</span><span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb304-7"><a href="plotting-two-or-more-dimensions.html#cb304-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb304-8"><a href="plotting-two-or-more-dimensions.html#cb304-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20scale%20row-1.png" width="672" /></p>
<p>This result is dramatically different, and possibly not what you intended. In
this case the effect is somewhat obvious - all the values in b are the largest,
the values in c are the smallest, and c is in between. However, in general this
may not be the case, and care should be taken to understand which dimension of
the data has been scaled.</p>
<div class="box warning">
<p>Because features are typically not assumed to be on the same scale, the base R
<code>heatmap()</code> and <code>heatmap2()</code> functions <strong>automatically scale the rows of the
data prior to visualization</strong>.</p>
</div>
</div>
<div id="total-data-range" class="section level4 hasAnchor" number="7.5.7.3">
<h4><span class="header-section-number">7.5.7.3</span> Total data range<a href="plotting-two-or-more-dimensions.html#total-data-range" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As we saw in the previous section on scaling features, the color mapping is
highly sensitive to the range of all values in the data. Even if the features or
samples have been properly scaled, extreme values in any of the features can
render a heatmap uninformative. Consider the following heatmap that visualizes
data that have a single extreme outlier:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="plotting-two-or-more-dimensions.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb305-2"><a href="plotting-two-or-more-dimensions.html#cb305-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb305-3"><a href="plotting-two-or-more-dimensions.html#cb305-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb305-4"><a href="plotting-two-or-more-dimensions.html#cb305-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb305-5"><a href="plotting-two-or-more-dimensions.html#cb305-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">9</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">1e9</span>)</span>
<span id="cb305-6"><a href="plotting-two-or-more-dimensions.html#cb305-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb305-7"><a href="plotting-two-or-more-dimensions.html#cb305-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb305-8"><a href="plotting-two-or-more-dimensions.html#cb305-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb305-9"><a href="plotting-two-or-more-dimensions.html#cb305-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20outlier-1.png" width="672" /></p>
<p>The single extreme value compressed all the other color values to the colors on
the lowest end of the color palette. This anomalous value must be removed before
differences between the other variables will be visible.</p>
<p>The issue above is caused by the fact that the default color gradient scales
assume there is a linear mapping between the values and the palette. This is
equivalent to assuming the data are relatively well distributed across a linear
range of values, as in a normal or uniform distribution. When the data do not
follow this assumption, any resulting heatmaps may suffer the same issue as
when there are extreme values. Consider the following heatmap with data randomly
sampled from an exponential distribution:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="plotting-two-or-more-dimensions.html#cb306-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb306-2"><a href="plotting-two-or-more-dimensions.html#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb306-3"><a href="plotting-two-or-more-dimensions.html#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="dv">10</span><span class="sc">**</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb306-4"><a href="plotting-two-or-more-dimensions.html#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="dv">10</span><span class="sc">**</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb306-5"><a href="plotting-two-or-more-dimensions.html#cb306-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="dv">10</span><span class="sc">**</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb306-6"><a href="plotting-two-or-more-dimensions.html#cb306-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb306-7"><a href="plotting-two-or-more-dimensions.html#cb306-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))</span>
<span id="cb306-8"><a href="plotting-two-or-more-dimensions.html#cb306-8" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb306-9"><a href="plotting-two-or-more-dimensions.html#cb306-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb306-10"><a href="plotting-two-or-more-dimensions.html#cb306-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20exponential-1.png" width="672" /></p>
<p>The data are similarly compressed toward the lower end of the scale due to the
uneven distribution of data. In this case, we might consider taking a log
transformation of the data prior to drawing the heatmap:</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="plotting-two-or-more-dimensions.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(data,</span>
<span id="cb307-2"><a href="plotting-two-or-more-dimensions.html#cb307-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">log10</span>(value)</span>
<span id="cb307-3"><a href="plotting-two-or-more-dimensions.html#cb307-3" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">%&gt;%</span></span>
<span id="cb307-4"><a href="plotting-two-or-more-dimensions.html#cb307-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb307-5"><a href="plotting-two-or-more-dimensions.html#cb307-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() </span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20log-1.png" width="672" /></p>
<p>On a log scale, the heatmap visualizes the range of values linearly across the
gradient. In this case, we knew a log transform was appropriate to cast the
data onto an approximately linear scale, though in general this will need to be
explored for each dataset.</p>
</div>
<div id="whether-or-not-the-data-are-centered" class="section level4 hasAnchor" number="7.5.7.4">
<h4><span class="header-section-number">7.5.7.4</span> Whether or not the data are centered<a href="plotting-two-or-more-dimensions.html#whether-or-not-the-data-are-centered" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The final important consideration when creating a heatmap with continuous values
is determining if there is a meaningful center for each feature. For certain
kinds of data, data points above and below a certain value have a particular
meaning. For example, log2 fold change values from differential expression
greater or less than zero indicate a gene is increased or decreased,
respectively, in the comparison of interest. When visualizing these values as a
heatmap, it is therefore important to indicate this central value with a color,
usually white or black, appropriately, so that colors above and below this
value can be set accordingly, e.g. above zero is red, below zero blue.</p>
<p>To do this, first a 3-color diverging palette is required, i.e. a palette with
one color on one side, a different color on the other side, and a third color in
the middle, usually white or black. The following is a heatmap of normally
distributed values with mean 0 and standard deviation of 1 visualized on a
diverging color scale:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="plotting-two-or-more-dimensions.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb308-2"><a href="plotting-two-or-more-dimensions.html#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb308-3"><a href="plotting-two-or-more-dimensions.html#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb308-4"><a href="plotting-two-or-more-dimensions.html#cb308-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb308-5"><a href="plotting-two-or-more-dimensions.html#cb308-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb308-6"><a href="plotting-two-or-more-dimensions.html#cb308-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb308-7"><a href="plotting-two-or-more-dimensions.html#cb308-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb308-8"><a href="plotting-two-or-more-dimensions.html#cb308-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb308-9"><a href="plotting-two-or-more-dimensions.html#cb308-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb308-10"><a href="plotting-two-or-more-dimensions.html#cb308-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">midpoint=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_files/viz-1.png" width="672" /></p>
<p>Note the <code>scale_fill_gradient2()</code> call, with <code>midpoint=0</code> argument. This
argument instructs the gradient to set the value of 0 to the middle color, which
is white. The midpoint of zero is default, but if your data are centered around
some other value, failing to specify this midpoint will produce misleading
visualizations:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="plotting-two-or-more-dimensions.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb309-2"><a href="plotting-two-or-more-dimensions.html#cb309-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb309-3"><a href="plotting-two-or-more-dimensions.html#cb309-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb309-4"><a href="plotting-two-or-more-dimensions.html#cb309-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb309-5"><a href="plotting-two-or-more-dimensions.html#cb309-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb309-6"><a href="plotting-two-or-more-dimensions.html#cb309-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb309-7"><a href="plotting-two-or-more-dimensions.html#cb309-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb309-8"><a href="plotting-two-or-more-dimensions.html#cb309-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb309-9"><a href="plotting-two-or-more-dimensions.html#cb309-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb309-10"><a href="plotting-two-or-more-dimensions.html#cb309-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>)</span></code></pre></div>
<p><img src="main_files/viz%20improper%20midpoint-1.png" width="672" /></p>
<p>Here our data are centered with a mean of 1, but the midpoint is still at its
default of zero. If we intend for 1 to be the midpoint corresponding to the
color white, we must specify it explicitly:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="plotting-two-or-more-dimensions.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb310-2"><a href="plotting-two-or-more-dimensions.html#cb310-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb310-3"><a href="plotting-two-or-more-dimensions.html#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb310-4"><a href="plotting-two-or-more-dimensions.html#cb310-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb310-5"><a href="plotting-two-or-more-dimensions.html#cb310-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb310-6"><a href="plotting-two-or-more-dimensions.html#cb310-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb310-7"><a href="plotting-two-or-more-dimensions.html#cb310-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb310-8"><a href="plotting-two-or-more-dimensions.html#cb310-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb310-9"><a href="plotting-two-or-more-dimensions.html#cb310-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb310-10"><a href="plotting-two-or-more-dimensions.html#cb310-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">midpoint=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="main_files/viz%20correct%20midpoint-1.png" width="672" /></p>
<p>If your features do not have a meaningful center, then the color palette scale
should generally have only two colors that range from either light to dark or
dark to light:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="plotting-two-or-more-dimensions.html#cb311-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb311-2"><a href="plotting-two-or-more-dimensions.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb311-3"><a href="plotting-two-or-more-dimensions.html#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb311-4"><a href="plotting-two-or-more-dimensions.html#cb311-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb311-5"><a href="plotting-two-or-more-dimensions.html#cb311-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb311-6"><a href="plotting-two-or-more-dimensions.html#cb311-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb311-7"><a href="plotting-two-or-more-dimensions.html#cb311-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))</span>
<span id="cb311-8"><a href="plotting-two-or-more-dimensions.html#cb311-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-9"><a href="plotting-two-or-more-dimensions.html#cb311-9" aria-hidden="true" tabindex="-1"></a>g_up <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb311-10"><a href="plotting-two-or-more-dimensions.html#cb311-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb311-11"><a href="plotting-two-or-more-dimensions.html#cb311-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>,<span class="at">high=</span><span class="st">&quot;#eeeeff&quot;</span>)</span>
<span id="cb311-12"><a href="plotting-two-or-more-dimensions.html#cb311-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-13"><a href="plotting-two-or-more-dimensions.html#cb311-13" aria-hidden="true" tabindex="-1"></a>g_dn <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb311-14"><a href="plotting-two-or-more-dimensions.html#cb311-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb311-15"><a href="plotting-two-or-more-dimensions.html#cb311-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#ffffff&quot;</span>,<span class="at">high=</span><span class="st">&quot;#000099&quot;</span>)</span>
<span id="cb311-16"><a href="plotting-two-or-more-dimensions.html#cb311-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-17"><a href="plotting-two-or-more-dimensions.html#cb311-17" aria-hidden="true" tabindex="-1"></a>g_up <span class="sc">|</span> g_dn</span></code></pre></div>
<p><img src="main_files/viz%20two%20color-1.png" width="672" /></p>
<p>The direction of the color palette depends on the meaning of the data, and is
a subjective choice.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualizing-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="other-kind-of-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="7.5 Plotting Two or More Dimensions | BF591 - R for Biological Sciences" />
<meta property="og:type" content="book" />







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="7.5 Plotting Two or More Dimensions | BF591 - R for Biological Sciences">

<title>7.5 Plotting Two or More Dimensions | BF591 - R for Biological Sciences</title>

<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/darkly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#syllabus">Syllabus</a>
<ul>
<li><a href="course-schedule.html#course-schedule">Course Schedule</a></li>
<li><a href="instructors.html#instructors">Instructors</a></li>
<li><a href="office-hours.html#office-hours">Office Hours</a></li>
<li><a href="course-values-and-policies.html#course-values-and-policies">Course Values and Policies</a></li>
</ul></li>
<li><a href="introduction.html#introduction"><span class="toc-section-number">1</span> Introduction</a>
<ul>
<li><a href="who-this-book-is-for.html#who-this-book-is-for"><span class="toc-section-number">1.1</span> Who This Book Is For</a></li>
<li><a href="a-note-about-reinventing-the-wheel.html#a-note-about-reinventing-the-wheel"><span class="toc-section-number">1.2</span> A Note About Reinventing the Wheel</a></li>
<li><a href="sources-and-references.html#sources-and-references"><span class="toc-section-number">1.3</span> Sources and References</a></li>
</ul></li>
<li><a href="data-bio.html#data-bio"><span class="toc-section-number">2</span> Data in Biology</a>
<ul>
<li><a href="a-brief-history-of-data-in-molecular-biology.html#a-brief-history-of-data-in-molecular-biology"><span class="toc-section-number">2.1</span> A Brief History of Data in Molecular Biology</a></li>
<li><a href="biology-as-a-mature-data-science.html#biology-as-a-mature-data-science"><span class="toc-section-number">2.2</span> Biology as a Mature Data Science</a></li>
</ul></li>
<li><a href="preliminaries.html#preliminaries"><span class="toc-section-number">3</span> Preliminaries</a>
<ul>
<li><a href="prelim-r.html#prelim-r"><span class="toc-section-number">3.1</span> The R Language</a></li>
<li><a href="prelim-rstudio.html#prelim-rstudio"><span class="toc-section-number">3.2</span> RStudio</a></li>
<li><a href="prog-the-r-script.html#prog-the-r-script"><span class="toc-section-number">3.3</span> The R Script</a></li>
<li><a href="prog-workflow.html#prog-workflow"><span class="toc-section-number">3.4</span> The Scripting Workflow</a></li>
<li><a href="prelim-git.html#prelim-git"><span class="toc-section-number">3.5</span> git + github</a>
<ul>
<li><a href="prelim-git.html#motivation"><span class="toc-section-number">3.5.1</span> Motivation</a></li>
<li><a href="prelim-git.html#git"><span class="toc-section-number">3.5.2</span> git</a></li>
<li><a href="prelim-git.html#git-hosting-platforms-github"><span class="toc-section-number">3.5.3</span> Git hosting platforms (GitHub)</a></li>
</ul></li>
</ul></li>
<li><a href="prog-basics.html#prog-basics"><span class="toc-section-number">4</span> R Programming</a>
<ul>
<li><a href="before-you-begin.html#before-you-begin"><span class="toc-section-number">4.1</span> Before you begin</a></li>
<li><a href="introduction-1.html#introduction-1"><span class="toc-section-number">4.2</span> Introduction</a></li>
<li><a href="prog-r-syntax.html#prog-r-syntax"><span class="toc-section-number">4.3</span> R Syntax Basics</a></li>
<li><a href="prog-types.html#prog-types"><span class="toc-section-number">4.4</span> Basic Types of Values</a>
<ul>
<li><a href="prog-types.html#factors"><span class="toc-section-number">4.4.1</span> Factors</a></li>
</ul></li>
<li><a href="prog-struct.html#prog-struct"><span class="toc-section-number">4.5</span> Data Structures</a>
<ul>
<li><a href="prog-struct.html#vectors"><span class="toc-section-number">4.5.1</span> Vectors</a></li>
<li><a href="prog-struct.html#matrices"><span class="toc-section-number">4.5.2</span> Matrices</a></li>
<li><a href="prog-struct.html#lists-and-data-frames"><span class="toc-section-number">4.5.3</span> Lists and data frames</a></li>
</ul></li>
<li><a href="logical-tests-and-comparators.html#logical-tests-and-comparators"><span class="toc-section-number">4.6</span> Logical Tests and Comparators</a></li>
<li><a href="functions.html#functions"><span class="toc-section-number">4.7</span> Functions</a>
<ul>
<li><a href="functions.html#prog-dry"><span class="toc-section-number">4.7.1</span> DRY: Don’t Repeat Yourself</a></li>
<li><a href="functions.html#writing-your-own-functions"><span class="toc-section-number">4.7.2</span> Writing your own functions</a></li>
<li><a href="functions.html#scope"><span class="toc-section-number">4.7.3</span> Scope</a></li>
</ul></li>
<li><a href="iteration.html#iteration"><span class="toc-section-number">4.8</span> Iteration</a>
<ul>
<li><a href="iteration.html#vectorized-operations"><span class="toc-section-number">4.8.1</span> Vectorized operations</a></li>
<li><a href="iteration.html#functional-programming"><span class="toc-section-number">4.8.2</span> Functional programming</a></li>
<li><a href="iteration.html#apply-and-friends"><span class="toc-section-number">4.8.3</span> <code>apply()</code> and friends</a></li>
</ul></li>
<li><a href="installing-packages.html#installing-packages"><span class="toc-section-number">4.9</span> Installing Packages</a></li>
<li><a href="saving-and-loading-r-data.html#saving-and-loading-r-data"><span class="toc-section-number">4.10</span> Saving and Loading R Data</a></li>
<li><a href="prog-debugging.html#prog-debugging"><span class="toc-section-number">4.11</span> Troubleshooting and Debugging</a></li>
<li><a href="prog-style.html#prog-style"><span class="toc-section-number">4.12</span> Coding Style and Conventions</a>
<ul>
<li><a href="prog-style.html#is-my-code-correct"><span class="toc-section-number">4.12.1</span> Is my code correct?</a></li>
<li><a href="prog-style.html#does-my-code-follow-the-dry-principle"><span class="toc-section-number">4.12.2</span> Does my code follow the <span>DRY principle</span>?</a></li>
<li><a href="prog-style.html#did-i-choose-concise-but-descriptive-variable-and-function-names"><span class="toc-section-number">4.12.3</span> Did I choose concise but descriptive variable and function names?</a></li>
<li><a href="prog-style.html#did-i-use-indentation-and-naming-conventions-consistently-throughout-my-code"><span class="toc-section-number">4.12.4</span> Did I use indentation and naming conventions consistently throughout my code?</a></li>
<li><a href="prog-style.html#did-i-write-comments-especially-when-what-the-code-does-is-not-obvious"><span class="toc-section-number">4.12.5</span> Did I write comments, especially when what the code does is not obvious?</a></li>
<li><a href="prog-style.html#how-easy-would-it-be-for-someone-else-to-understand-my-code"><span class="toc-section-number">4.12.6</span> How easy would it be for someone else to understand my code?</a></li>
<li><a href="prog-style.html#is-my-code-easy-to-maintainchange"><span class="toc-section-number">4.12.7</span> Is my code easy to maintain/change?</a></li>
<li><a href="prog-style.html#the-styler-package"><span class="toc-section-number">4.12.8</span> The <code>styler</code> package</a></li>
</ul></li>
</ul></li>
<li><a href="data-wrangling.html#data-wrangling"><span class="toc-section-number">5</span> Data Wrangling</a>
<ul>
<li><a href="the-tidyverse.html#the-tidyverse"><span class="toc-section-number">5.1</span> The Tidyverse</a></li>
<li><a href="dw-basics.html#dw-basics"><span class="toc-section-number">5.2</span> Tidyverse Basics</a></li>
<li><a href="importing-data.html#importing-data"><span class="toc-section-number">5.3</span> Importing Data</a></li>
<li><a href="data-tibble.html#data-tibble"><span class="toc-section-number">5.4</span> The tibble</a></li>
<li><a href="tidy-data.html#tidy-data"><span class="toc-section-number">5.5</span> Tidy Data</a></li>
<li><a href="pipes.html#pipes"><span class="toc-section-number">5.6</span> pipes</a></li>
<li><a href="arranging-data.html#arranging-data"><span class="toc-section-number">5.7</span> Arranging Data</a>
<ul>
<li><a href="arranging-data.html#dplyrmutate---create-new-columns-using-other-columns"><span class="toc-section-number">5.7.1</span> <code>dplyr::mutate()</code> - Create new columns using other columns</a></li>
<li><a href="arranging-data.html#stringr---working-with-character-values"><span class="toc-section-number">5.7.2</span> <code>stringr</code> - Working with character values</a></li>
<li><a href="arranging-data.html#dplyrselect---subset-columns-by-name"><span class="toc-section-number">5.7.3</span> <code>dplyr::select()</code> - Subset Columns by Name</a></li>
<li><a href="arranging-data.html#dplyrfilter---pick-rows-out-of-a-data-set"><span class="toc-section-number">5.7.4</span> <code>dplyr::filter()</code> - Pick rows out of a data set</a></li>
<li><a href="arranging-data.html#dplyrarrange---order-rows-based-on-their-values"><span class="toc-section-number">5.7.5</span> <code>dplyr::arrange()</code> - Order rows based on their values</a></li>
<li><a href="arranging-data.html#putting-it-all-together"><span class="toc-section-number">5.7.6</span> Putting it all together</a></li>
</ul></li>
<li><a href="grouping-data.html#grouping-data"><span class="toc-section-number">5.8</span> Grouping Data</a></li>
<li><a href="rearranging-data.html#rearranging-data"><span class="toc-section-number">5.9</span> Rearranging Data</a></li>
<li><a href="relational-data.html#relational-data"><span class="toc-section-number">5.10</span> Relational Data</a>
<ul>
<li><a href="relational-data.html#dealing-with-multiple-matches"><span class="toc-section-number">5.10.1</span> Dealing with multiple matches</a></li>
</ul></li>
</ul></li>
<li><a href="data-science.html#data-science"><span class="toc-section-number">6</span> Data Science</a>
<ul>
<li><a href="data-modeling.html#data-modeling"><span class="toc-section-number">6.1</span> Data Modeling</a>
<ul>
<li><a href="data-modeling.html#a-worked-modeling-example"><span class="toc-section-number">6.1.1</span> A Worked Modeling Example</a></li>
<li><a href="data-modeling.html#data-summarization"><span class="toc-section-number">6.1.2</span> Data Summarization</a></li>
<li><a href="data-modeling.html#linear-models"><span class="toc-section-number">6.1.3</span> Linear Models</a></li>
<li><a href="data-modeling.html#flavors-of-linear-models"><span class="toc-section-number">6.1.4</span> Flavors of Linear Models</a></li>
<li><a href="data-modeling.html#assessing-model-accuracy-."><span class="toc-section-number">6.1.5</span> Assessing Model Accuracy .</a></li>
</ul></li>
<li><a href="statistical-distributions.html#statistical-distributions"><span class="toc-section-number">6.2</span> Statistical Distributions</a>
<ul>
<li><a href="statistical-distributions.html#random-variables"><span class="toc-section-number">6.2.1</span> Random Variables</a></li>
<li><a href="statistical-distributions.html#statistical-distribution-basics"><span class="toc-section-number">6.2.2</span> Statistical Distribution Basics</a></li>
<li><a href="statistical-distributions.html#distributions-in-r"><span class="toc-section-number">6.2.3</span> Distributions in R</a></li>
<li><a href="statistical-distributions.html#discrete-distributions"><span class="toc-section-number">6.2.4</span> Discrete Distributions</a></li>
<li><a href="statistical-distributions.html#continuous-distributions"><span class="toc-section-number">6.2.5</span> Continuous Distributions</a></li>
<li><a href="statistical-distributions.html#empirical-distributions"><span class="toc-section-number">6.2.6</span> Empirical Distributions</a></li>
</ul></li>
<li><a href="statistical-tests.html#statistical-tests"><span class="toc-section-number">6.3</span> Statistical Tests</a>
<ul>
<li><a href="statistical-tests.html#what-is-a-statistical-test"><span class="toc-section-number">6.3.1</span> What is a statistical test</a></li>
<li><a href="statistical-tests.html#common-statistical-tests"><span class="toc-section-number">6.3.2</span> Common Statistical Tests</a></li>
<li><a href="statistical-tests.html#choosing-a-test"><span class="toc-section-number">6.3.3</span> Choosing a Test</a></li>
<li><a href="statistical-tests.html#p-values"><span class="toc-section-number">6.3.4</span> P-values</a></li>
<li><a href="statistical-tests.html#multiple-hypothesis-testing-."><span class="toc-section-number">6.3.5</span> Multiple Hypothesis Testing .</a></li>
<li><a href="statistical-tests.html#statistical-power"><span class="toc-section-number">6.3.6</span> Statistical power</a></li>
</ul></li>
<li><a href="exploratory-data-analysis.html#exploratory-data-analysis"><span class="toc-section-number">6.4</span> Exploratory Data Analysis</a>
<ul>
<li><a href="exploratory-data-analysis.html#principal-component-analysis"><span class="toc-section-number">6.4.1</span> Principal Component Analysis</a></li>
<li><a href="exploratory-data-analysis.html#cluster-analysis"><span class="toc-section-number">6.4.2</span> Cluster Analysis</a></li>
<li><a href="exploratory-data-analysis.html#k-means-."><span class="toc-section-number">6.4.3</span> k-means .</a></li>
<li><a href="exploratory-data-analysis.html#others"><span class="toc-section-number">6.4.4</span> Others</a></li>
</ul></li>
<li><a href="network-analysis-..html#network-analysis-."><span class="toc-section-number">6.5</span> Network Analysis .</a>
<ul>
<li><a href="network-analysis-..html#basic-network-analysis"><span class="toc-section-number">6.5.1</span> Basic network analysis</a></li>
<li><a href="network-analysis-..html#create-your-own"><span class="toc-section-number">6.5.2</span> Create your own</a></li>
</ul></li>
</ul></li>
<li><a href="data-visualization.html#data-visualization"><span class="toc-section-number">7</span> Data Visualization</a>
<ul>
<li><a href="responsible-plotting.html#responsible-plotting"><span class="toc-section-number">7.1</span> Responsible Plotting</a>
<ul>
<li><a href="responsible-plotting.html#visualization-principles"><span class="toc-section-number">7.1.1</span> Visualization Principles</a></li>
<li><a href="responsible-plotting.html#human-visual-perception"><span class="toc-section-number">7.1.2</span> Human Visual Perception</a></li>
<li><a href="responsible-plotting.html#visual-encodings"><span class="toc-section-number">7.1.3</span> Visual Encodings</a></li>
<li><a href="responsible-plotting.html#some-opinionated-rules-of-thumb"><span class="toc-section-number">7.1.4</span> Some Opinionated Rules of Thumb</a></li>
</ul></li>
<li><a href="dv-gg.html#dv-gg"><span class="toc-section-number">7.2</span> Grammar of Graphics</a>
<ul>
<li><a href="dv-gg.html#ggplot-mechanics"><span class="toc-section-number">7.2.1</span> <code>ggplot</code> mechanics</a></li>
</ul></li>
<li><a href="plotting-one-dimension.html#plotting-one-dimension"><span class="toc-section-number">7.3</span> Plotting One Dimension</a>
<ul>
<li><a href="plotting-one-dimension.html#dv-bar"><span class="toc-section-number">7.3.1</span> Bar chart</a></li>
<li><a href="plotting-one-dimension.html#lollipop-plots"><span class="toc-section-number">7.3.2</span> Lollipop plots</a></li>
<li><a href="plotting-one-dimension.html#stacked-area-charts"><span class="toc-section-number">7.3.3</span> Stacked Area charts</a></li>
<li><a href="plotting-one-dimension.html#parallel-coordinate-plots"><span class="toc-section-number">7.3.4</span> Parallel Coordinate plots</a></li>
</ul></li>
<li><a href="visualizing-distributions.html#visualizing-distributions"><span class="toc-section-number">7.4</span> Visualizing Distributions</a>
<ul>
<li><a href="visualizing-distributions.html#histogram"><span class="toc-section-number">7.4.1</span> Histogram</a></li>
<li><a href="visualizing-distributions.html#density"><span class="toc-section-number">7.4.2</span> Density</a></li>
<li><a href="visualizing-distributions.html#boxplot"><span class="toc-section-number">7.4.3</span> Boxplot</a></li>
<li><a href="visualizing-distributions.html#violin-plot"><span class="toc-section-number">7.4.4</span> Violin plot</a></li>
<li><a href="visualizing-distributions.html#beeswarm-plot"><span class="toc-section-number">7.4.5</span> Beeswarm plot</a></li>
<li><a href="visualizing-distributions.html#ridgeline"><span class="toc-section-number">7.4.6</span> Ridgeline</a></li>
</ul></li>
<li><a href="plotting-two-or-more-dimensions.html#plotting-two-or-more-dimensions"><span class="toc-section-number">7.5</span> Plotting Two or More Dimensions</a>
<ul>
<li><a href="plotting-two-or-more-dimensions.html#scatter-plots"><span class="toc-section-number">7.5.1</span> Scatter Plots</a></li>
<li><a href="plotting-two-or-more-dimensions.html#bubble-plots"><span class="toc-section-number">7.5.2</span> Bubble Plots</a></li>
<li><a href="plotting-two-or-more-dimensions.html#connected-scatter-plots"><span class="toc-section-number">7.5.3</span> Connected Scatter Plots</a></li>
<li><a href="plotting-two-or-more-dimensions.html#line-plots"><span class="toc-section-number">7.5.4</span> Line Plots</a></li>
<li><a href="plotting-two-or-more-dimensions.html#parallel-coordinate-plots-1"><span class="toc-section-number">7.5.5</span> Parallel Coordinate Plots</a></li>
<li><a href="plotting-two-or-more-dimensions.html#heatmaps"><span class="toc-section-number">7.5.6</span> Heatmaps</a></li>
<li><a href="plotting-two-or-more-dimensions.html#how-to-use-heatmaps-responsibly"><span class="toc-section-number">7.5.7</span> How To Use Heatmaps Responsibly</a></li>
</ul></li>
<li><a href="other-kind-of-plots.html#other-kind-of-plots"><span class="toc-section-number">7.6</span> Other Kind of Plots</a>
<ul>
<li><a href="other-kind-of-plots.html#dendrograms"><span class="toc-section-number">7.6.1</span> Dendrograms</a></li>
<li><a href="other-kind-of-plots.html#chord-diagrams-and-circos-plots"><span class="toc-section-number">7.6.2</span> Chord Diagrams and Circos Plots</a></li>
</ul></li>
<li><a href="multiple-plots.html#multiple-plots"><span class="toc-section-number">7.7</span> Multiple Plots</a>
<ul>
<li><a href="multiple-plots.html#facet-wrapping"><span class="toc-section-number">7.7.1</span> Facet wrapping</a></li>
<li><a href="multiple-plots.html#multipanel-figures"><span class="toc-section-number">7.7.2</span> Multipanel Figures</a></li>
</ul></li>
<li><a href="publication-ready-plots.html#publication-ready-plots"><span class="toc-section-number">7.8</span> Publication Ready Plots</a>
<ul>
<li><a href="publication-ready-plots.html#ggplot-themes"><span class="toc-section-number">7.8.1</span> <code>ggplot</code> Themes</a></li>
<li><a href="publication-ready-plots.html#exporting-to-svg"><span class="toc-section-number">7.8.2</span> Exporting to SVG</a></li>
</ul></li>
<li><a href="network-visualization.html#network-visualization"><span class="toc-section-number">7.9</span> Network visualization</a>
<ul>
<li><a href="network-visualization.html#interactive-network-plots"><span class="toc-section-number">7.9.1</span> Interactive network plots</a></li>
</ul></li>
</ul></li>
<li><a href="biology-bioinformatics.html#biology-bioinformatics"><span class="toc-section-number">8</span> Biology &amp; Bioinformatics</a>
<ul>
<li><a href="bio-r.html#bio-r"><span class="toc-section-number">8.1</span> R in Biology</a></li>
<li><a href="biological-data-overview.html#biological-data-overview"><span class="toc-section-number">8.2</span> Biological Data Overview</a>
<ul>
<li><a href="biological-data-overview.html#bio-data-types"><span class="toc-section-number">8.2.1</span> Types of Biological Data</a></li>
<li><a href="biological-data-overview.html#csv-files"><span class="toc-section-number">8.2.2</span> CSV Files</a></li>
<li><a href="biological-data-overview.html#biological-data-is-not-tidy"><span class="toc-section-number">8.2.3</span> Biological data is NOT Tidy!</a></li>
</ul></li>
<li><a href="bio-bioconductor.html#bio-bioconductor"><span class="toc-section-number">8.3</span> Bioconductor</a></li>
<li><a href="microarrays.html#microarrays"><span class="toc-section-number">8.4</span> Microarrays</a></li>
<li><a href="high-throughput-sequencing.html#high-throughput-sequencing"><span class="toc-section-number">8.5</span> High Throughput Sequencing</a>
<ul>
<li><a href="high-throughput-sequencing.html#raw-hts-data"><span class="toc-section-number">8.5.1</span> Raw HTS Data</a></li>
<li><a href="high-throughput-sequencing.html#preliminary-hts-data-analysis"><span class="toc-section-number">8.5.2</span> Preliminary HTS Data Analysis</a></li>
<li><a href="high-throughput-sequencing.html#count-data"><span class="toc-section-number">8.5.3</span> Count Data</a></li>
</ul></li>
<li><a href="gene-identifiers.html#gene-identifiers"><span class="toc-section-number">8.6</span> Gene Identifiers</a>
<ul>
<li><a href="gene-identifiers.html#gene-identifier-systems"><span class="toc-section-number">8.6.1</span> Gene Identifier Systems</a></li>
<li><a href="gene-identifiers.html#mapping-between-identifier-systems"><span class="toc-section-number">8.6.2</span> Mapping Between Identifier Systems</a></li>
<li><a href="gene-identifiers.html#mapping-homologs"><span class="toc-section-number">8.6.3</span> Mapping Homologs</a></li>
</ul></li>
<li><a href="gene-expression.html#gene-expression"><span class="toc-section-number">8.7</span> Gene Expression</a>
<ul>
<li><a href="gene-expression.html#gene-expression-data-in-bioconductor"><span class="toc-section-number">8.7.1</span> Gene Expression Data in Bioconductor</a></li>
<li><a href="gene-expression.html#differential-expression-analysis"><span class="toc-section-number">8.7.2</span> Differential Expression Analysis</a></li>
<li><a href="gene-expression.html#microarray-gene-expression-data"><span class="toc-section-number">8.7.3</span> Microarray Gene Expression Data</a></li>
<li><a href="gene-expression.html#differential-expression-microarrays-limma"><span class="toc-section-number">8.7.4</span> Differential Expression: Microarrays (limma)</a></li>
<li><a href="gene-expression.html#rnaseq"><span class="toc-section-number">8.7.5</span> RNASeq</a></li>
<li><a href="gene-expression.html#rnaseq-gene-expression-data"><span class="toc-section-number">8.7.6</span> RNASeq Gene Expression Data</a></li>
<li><a href="gene-expression.html#filtering-counts"><span class="toc-section-number">8.7.7</span> Filtering Counts</a></li>
<li><a href="gene-expression.html#count-distributions"><span class="toc-section-number">8.7.8</span> Count Distributions</a></li>
<li><a href="gene-expression.html#differential-expression-rnaseq"><span class="toc-section-number">8.7.9</span> Differential Expression: RNASeq</a></li>
</ul></li>
<li><a href="gene-set-enrichment-analysis.html#gene-set-enrichment-analysis"><span class="toc-section-number">8.8</span> Gene Set Enrichment Analysis</a>
<ul>
<li><a href="gene-set-enrichment-analysis.html#gene-sets"><span class="toc-section-number">8.8.1</span> Gene Sets</a></li>
<li><a href="gene-set-enrichment-analysis.html#working-with-gene-sets-in-r"><span class="toc-section-number">8.8.2</span> Working with gene sets in R</a></li>
<li><a href="gene-set-enrichment-analysis.html#over-representation-analysis"><span class="toc-section-number">8.8.3</span> Over-representation Analysis</a></li>
<li><a href="gene-set-enrichment-analysis.html#rank-based-analysis"><span class="toc-section-number">8.8.4</span> Rank-based Analysis</a></li>
<li><a href="gene-set-enrichment-analysis.html#fgsea"><span class="toc-section-number">8.8.5</span> fgsea</a></li>
</ul></li>
<li><a href="biological-networks-..html#biological-networks-."><span class="toc-section-number">8.9</span> Biological Networks .</a>
<ul>
<li><a href="biological-networks-..html#biological-pathways-."><span class="toc-section-number">8.9.1</span> Biological Pathways .</a></li>
<li><a href="biological-networks-..html#gene-regulatory-networks-."><span class="toc-section-number">8.9.2</span> Gene Regulatory Networks .</a></li>
<li><a href="biological-networks-..html#protein-protein-interaction-network-."><span class="toc-section-number">8.9.3</span> Protein-Protein Interaction Network .</a></li>
<li><a href="biological-networks-..html#wgcna-."><span class="toc-section-number">8.9.4</span> WGCNA .</a></li>
</ul></li>
</ul></li>
<li><a href="engineering.html#engineering"><span class="toc-section-number">9</span> EngineeRing</a>
<ul>
<li><a href="unit-testing.html#unit-testing"><span class="toc-section-number">9.1</span> Unit Testing</a></li>
<li><a href="toolification.html#toolification"><span class="toc-section-number">9.2</span> Toolification</a>
<ul>
<li><a href="toolification.html#the-r-interpreter"><span class="toc-section-number">9.2.1</span> The R Interpreter</a></li>
<li><a href="toolification.html#rscript"><span class="toc-section-number">9.2.2</span> <code>Rscript</code></a></li>
<li><a href="toolification.html#commandargs"><span class="toc-section-number">9.2.3</span> <code>commandArgs()</code></a></li>
</ul></li>
<li><a href="parallel-processing.html#parallel-processing"><span class="toc-section-number">9.3</span> Parallel Processing</a>
<ul>
<li><a href="parallel-processing.html#brief-introduction-to-parallelization"><span class="toc-section-number">9.3.1</span> Brief Introduction to Parallelization</a></li>
<li><a href="parallel-processing.html#apply-and-friends-are-pleasingly-parallel"><span class="toc-section-number">9.3.2</span> <code>apply</code> and Friends Are Pleasingly Parallel</a></li>
<li><a href="parallel-processing.html#the-parallel-package"><span class="toc-section-number">9.3.3</span> The <code>parallel</code> package</a></li>
</ul></li>
<li><a href="object-orientation-in-r.html#object-orientation-in-r"><span class="toc-section-number">9.4</span> Object Orientation in R</a></li>
<li><a href="r-packages.html#r-packages"><span class="toc-section-number">9.5</span> R Packages</a></li>
</ul></li>
<li><a href="rshiny.html#rshiny"><span class="toc-section-number">10</span> RShiny</a>
<ul>
<li><a href="rshiny-introduction.html#rshiny-introduction"><span class="toc-section-number">10.1</span> RShiny Introduction</a>
<ul>
<li><a href="rshiny-introduction.html#how-does-a-web-page-work"><span class="toc-section-number">10.1.1</span> How does a web page work?</a></li>
</ul></li>
<li><a href="application-structure.html#application-structure"><span class="toc-section-number">10.2</span> Application Structure</a>
<ul>
<li><a href="application-structure.html#ui-design"><span class="toc-section-number">10.2.1</span> UI Design</a></li>
<li><a href="application-structure.html#server-functionality"><span class="toc-section-number">10.2.2</span> Server Functionality</a></li>
</ul></li>
<li><a href="reactivity.html#reactivity"><span class="toc-section-number">10.3</span> Reactivity</a></li>
<li><a href="publishing.html#publishing"><span class="toc-section-number">10.4</span> Publishing</a></li>
</ul></li>
<li><a href="communicating-with-r.html#communicating-with-r"><span class="toc-section-number">11</span> Communicating with R</a>
<ul>
<li><a href="rmarkdown-knitr.html#rmarkdown-knitr"><span class="toc-section-number">11.1</span> RMarkdown &amp; knitr</a></li>
<li><a href="bookdown.html#bookdown"><span class="toc-section-number">11.2</span> bookdown</a></li>
</ul></li>
<li><a href="contribution-guide.html#contribution-guide"><span class="toc-section-number">12</span> Contribution Guide</a>
<ul>
<li><a href="custom-blocks.html#custom-blocks"><span class="toc-section-number">12.1</span> Custom blocks</a></li>
</ul></li>
<li><a href="assignments.html#assignments">Assignments</a>
<ul>
<li><a href="assignment-format.html#assignment-format">Assignment Format</a></li>
<li><a href="starting-an-assignment.html#starting-an-assignment">Starting an Assignment</a>
<ul>
<li><a href="starting-an-assignment.html#starting-your-own-git-repository-and-cloning-it">Starting your own <code>git</code> repository and cloning it</a></li>
<li><a href="starting-an-assignment.html#contents">Contents</a></li>
<li><a href="starting-an-assignment.html#github-tutorial">GitHub tutorial</a></li>
<li><a href="starting-an-assignment.html#committing-and-pushing-with-r-and-without">Committing and Pushing with R (and without)</a></li>
<li><a href="starting-an-assignment.html#using-rstudio">Using RStudio</a></li>
<li><a href="starting-an-assignment.html#using-the-command-line">Using the command line</a></li>
</ul></li>
<li><a href="assignment-1.html#assignment-1">Assignment 1</a>
<ul>
<li><a href="assignment-1.html#problem-statement">Problem Statement</a></li>
<li><a href="assignment-1.html#learning-objectives-and-skill-list">Learning Objectives and Skill List</a></li>
<li><a href="assignment-1.html#instructions">Instructions</a></li>
<li><a href="assignment-1.html#hints">Hints</a></li>
</ul></li>
<li><a href="assignment-2.html#assignment-2">Assignment 2</a>
<ul>
<li><a href="assignment-2.html#problem-statement-1">Problem Statement</a></li>
<li><a href="assignment-2.html#learning-objectives">Learning Objectives</a></li>
<li><a href="assignment-2.html#skill-list">Skill List</a></li>
<li><a href="assignment-2.html#instructions-1">Instructions</a></li>
<li><a href="assignment-2.html#function-details">Function Details</a></li>
</ul></li>
<li><a href="assignment-3.html#assignment-3">Assignment 3</a>
<ul>
<li><a href="assignment-3.html#problem-statement-2">Problem Statement</a></li>
<li><a href="assignment-3.html#learning-objectives-1">Learning Objectives</a></li>
<li><a href="assignment-3.html#skill-list-1">Skill List</a></li>
<li><a href="assignment-3.html#background-on-microarrays">Background on Microarrays</a></li>
<li><a href="assignment-3.html#background-on-principal-component-analysis">Background on Principal Component Analysis</a></li>
<li><a href="assignment-3.html#marisa-et-al.-gene-expression-classification-of-colon-cancer-into-molecular-subtypes-characterization-validation-and-prognostic-value.-plos-medicine-may-2013.-pmid-23700391">Marisa et al. Gene Expression Classification of Colon Cancer into Molecular Subtypes: Characterization, Validation, and Prognostic Value. PLoS Medicine, May 2013. PMID: 23700391</a></li>
<li><a href="assignment-3.html#scaling-data-using-r-scale">Scaling data using R <code>scale()</code></a></li>
<li><a href="assignment-3.html#proportion-of-variance-explained">Proportion of variance explained</a></li>
<li><a href="assignment-3.html#plotting-and-visualization-of-pca">Plotting and visualization of PCA</a></li>
<li><a href="assignment-3.html#hierarchical-clustering-and-heatmaps">Hierarchical Clustering and Heatmaps</a></li>
<li><a href="assignment-3.html#references">References</a></li>
</ul></li>
<li><a href="assignment-4.html#assignment-4">Assignment 4</a>
<ul>
<li><a href="assignment-4.html#problem-statement-3">Problem Statement</a></li>
<li><a href="assignment-4.html#learning-objectives-2">Learning Objectives</a></li>
<li><a href="assignment-4.html#skill-list-2">Skill List</a></li>
<li><a href="assignment-4.html#instructions-2">Instructions</a></li>
<li><a href="assignment-4.html#deliverables">Deliverables</a></li>
<li><a href="assignment-4.html#function-details-1">Function Details</a></li>
<li><a href="assignment-4.html#hints-1">Hints</a></li>
</ul></li>
<li><a href="assignment-5.html#assignment-5">Assignment 5</a>
<ul>
<li><a href="assignment-5.html#problem-statement-4">Problem Statement</a></li>
<li><a href="assignment-5.html#learning-objectives-3">Learning Objectives</a></li>
<li><a href="assignment-5.html#skill-list-3">Skill List</a></li>
<li><a href="assignment-5.html#deseq2-background">DESeq2 Background</a></li>
<li><a href="assignment-5.html#generating-a-counts-matrix">Generating a counts matrix</a></li>
<li><a href="assignment-5.html#prefiltering-counts-matrix">Prefiltering Counts matrix</a></li>
<li><a href="assignment-5.html#median-of-ratios-normalization">Median-of-ratios normalization</a></li>
<li><a href="assignment-5.html#deseq2-preparation">DESeq2 preparation</a></li>
<li><a href="assignment-5.html#omeara-et-al.-transcriptional-reversion-of-cardiac-myocyte-fate-during-mammalian-cardiac-regeneration.-circ-res.-feb-2015.-pmid-25477501l">O’Meara et al. Transcriptional Reversion of Cardiac Myocyte Fate During Mammalian Cardiac Regeneration. Circ Res. Feb 2015. PMID: 25477501l</a></li>
<li><a href="assignment-5.html#reading-and-subsetting-the-data-from-verse_counts.tsv-and-sample_metadata.csv">1. Reading and subsetting the data from verse_counts.tsv and sample_metadata.csv</a></li>
<li><a href="assignment-5.html#running-deseq2">2. Running DESeq2</a></li>
<li><a href="assignment-5.html#annotating-results-to-construct-a-labeled-volcano-plot">3. Annotating results to construct a labeled volcano plot</a></li>
<li><a href="assignment-5.html#diagnostic-plot-of-the-raw-p-values-for-all-genes">4. Diagnostic plot of the raw p-values for all genes</a></li>
<li><a href="assignment-5.html#plotting-the-logfoldchanges-for-differentially-expressed-genes">5. Plotting the LogFoldChanges for differentially expressed genes</a></li>
<li><a href="assignment-5.html#the-choice-of-fdr-cutoff-depends-on-cost">The choice of FDR cutoff depends on cost</a></li>
<li><a href="assignment-5.html#plotting-the-normalized-counts-of-differentially-expressed-genes">6. Plotting the normalized counts of differentially expressed genes</a></li>
<li><a href="assignment-5.html#volcano-plot-to-visualize-differential-expression-results">7. Volcano Plot to visualize differential expression results</a></li>
<li><a href="assignment-5.html#running-fgsea-vignette">8. Running fgsea <span>vignette</span></a></li>
<li><a href="assignment-5.html#plotting-the-top-ten-positive-nes-and-top-ten-negative-nes-pathways">9. Plotting the top ten positive NES and top ten negative NES pathways</a></li>
<li><a href="assignment-5.html#references-1">References</a></li>
</ul></li>
<li><a href="assignment-6.html#assignment-6">Assignment 6</a>
<ul>
<li><a href="assignment-6.html#problem-statement-5">Problem Statement</a></li>
<li><a href="assignment-6.html#learning-objectives-4">Learning Objectives</a></li>
<li><a href="assignment-6.html#skill-list-4">Skill List</a></li>
<li><a href="assignment-6.html#instructions-3">Instructions</a></li>
<li><a href="assignment-6.html#function-details-2">Function Details</a></li>
</ul></li>
<li><a href="assignment-7.html#assignment-7">Assignment 7</a>
<ul>
<li><a href="assignment-7.html#problem-statement-6">Problem Statement</a></li>
<li><a href="assignment-7.html#learning-objectives-5">Learning Objectives</a></li>
<li><a href="assignment-7.html#skill-list-5">Skill List</a></li>
<li><a href="assignment-7.html#instructions-4">Instructions</a></li>
<li><a href="assignment-7.html#function-details-3">“Function” Details</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li><a href="class-outlines.html#class-outlines"><span class="toc-section-number">A</span> Class Outlines</a>
<ul>
<li><a href="week-1.html#week-1"><span class="toc-section-number">A.1</span> Week 1</a></li>
<li><a href="week-2.html#week-2"><span class="toc-section-number">A.2</span> Week 2</a></li>
<li><a href="week-3.html#week-3"><span class="toc-section-number">A.3</span> Week 3</a></li>
<li><a href="week-4.html#week-4"><span class="toc-section-number">A.4</span> Week 4</a></li>
<li><a href="week-5.html#week-5"><span class="toc-section-number">A.5</span> Week 5</a></li>
<li><a href="week-6.html#week-6"><span class="toc-section-number">A.6</span> Week 6</a></li>
<li><a href="week-7.html#week-7"><span class="toc-section-number">A.7</span> Week 7</a></li>
<li><a href="week-8.html#week-8"><span class="toc-section-number">A.8</span> Week 8</a></li>
<li><a href="week-9.html#week-9"><span class="toc-section-number">A.9</span> Week 9</a></li>
<li><a href="week-10.html#week-10"><span class="toc-section-number">A.10</span> Week 10</a></li>
<li><a href="week-11.html#week-11"><span class="toc-section-number">A.11</span> Week 11</a></li>
<li><a href="week-12.html#week-12"><span class="toc-section-number">A.12</span> Week 12</a></li>
<li><a href="week-13.html#week-13"><span class="toc-section-number">A.13</span> Week 13</a></li>
<li><a href="week-14.html#week-14"><span class="toc-section-number">A.14</span> Week 14</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="plotting-two-or-more-dimensions" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Plotting Two or More Dimensions</h2>
<p>Multi-dimensional plots allow relationships between different quantities to be
depicted visually. As mentioned in the [Elemental Perceptual Tasks] section,
this involves mapping data to visual elements using different encodings. The
plot types in this section are examples of these different approaches to
combining visual data encodings.</p>
<div id="scatter-plots" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Scatter Plots</h3>
<p>Scatter plots visualize pairs of quantities, usually continuous, as points in
a two dimensional space. Most commonly, the points are plotted in <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_system">cartesian
coordinates</a>, but
<a href="https://en.wikipedia.org/wiki/Polar_coordinate_system">polar coordinates</a> or
other types of coordinate systems.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="plotting-two-or-more-dimensions.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau)) <span class="sc">+</span></span>
<span id="cb296-2"><a href="plotting-two-or-more-dimensions.html#cb296-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="main_files/viz%20dim%20scatter-1.png" width="672" /></p>
<p>The <code>geom_point()</code> geometry draws a shape, circle by default, at pixel
coordinates proportional to each <span class="math inline">\((x,y)\)</span> pair. The shape may be changed by
specifying the <code>shape=N</code> parameter to <code>geom_point</code>, where <code>N</code> is an integer ID
of the shape. The following plot shows which IDs correspond to which shapes:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="plotting-two-or-more-dimensions.html#cb297-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()</span>
<span id="cb297-2"><a href="plotting-two-or-more-dimensions.html#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb297-3"><a href="plotting-two-or-more-dimensions.html#cb297-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(y <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb297-4"><a href="plotting-two-or-more-dimensions.html#cb297-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(x<span class="sc">+</span>y<span class="sc">*</span><span class="dv">6</span> <span class="sc">&lt;</span> <span class="dv">26</span>) {</span>
<span id="cb297-5"><a href="plotting-two-or-more-dimensions.html#cb297-5" aria-hidden="true" tabindex="-1"></a>      g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="fu">tibble</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">shape=</span>x<span class="sc">+</span>y<span class="sc">*</span><span class="dv">6</span>,<span class="at">size=</span><span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb297-6"><a href="plotting-two-or-more-dimensions.html#cb297-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y<span class="fl">+0.5</span>,<span class="at">label=</span>label),<span class="fu">tibble</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">label=</span>x<span class="sc">+</span>y<span class="sc">*</span><span class="dv">6</span>))</span>
<span id="cb297-7"><a href="plotting-two-or-more-dimensions.html#cb297-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb297-8"><a href="plotting-two-or-more-dimensions.html#cb297-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb297-9"><a href="plotting-two-or-more-dimensions.html#cb297-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb297-10"><a href="plotting-two-or-more-dimensions.html#cb297-10" aria-hidden="true" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="main_files/point%20shapes-1.png" width="672" /></p>
<p>However, <code>geom_points()</code> will choose up to six different shapes for you if you
map a categorical encoding to the <code>shape</code> aesthetic:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="plotting-two-or-more-dimensions.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">shape=</span>condition)) <span class="sc">+</span></span>
<span id="cb298-2"><a href="plotting-two-or-more-dimensions.html#cb298-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="main_files/scatter%20shape%20enc-1.png" width="672" />
Controlling which shapes are mapped to which value can be accomplished with
<a href="https://ggplot2.tidyverse.org/reference/scale_manual.html"><code>scale_shape_manual()</code></a>:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="plotting-two-or-more-dimensions.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">shape=</span>condition)) <span class="sc">+</span></span>
<span id="cb299-2"><a href="plotting-two-or-more-dimensions.html#cb299-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb299-3"><a href="plotting-two-or-more-dimensions.html#cb299-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">9</span>))</span></code></pre></div>
<p><img src="main_files/scatter%20shape%20manual-1.png" width="672" /></p>
<p>Color encodings can also be added using either a continuous or discrete values:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="plotting-two-or-more-dimensions.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb300-2"><a href="plotting-two-or-more-dimensions.html#cb300-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ad_metadata)</span>
<span id="cb300-3"><a href="plotting-two-or-more-dimensions.html#cb300-3" aria-hidden="true" tabindex="-1"></a>g_condition <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">color=</span>condition),<span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb300-4"><a href="plotting-two-or-more-dimensions.html#cb300-4" aria-hidden="true" tabindex="-1"></a>g_age <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">color=</span>age_at_death),<span class="at">size=</span><span class="dv">3</span>)</span>
<span id="cb300-5"><a href="plotting-two-or-more-dimensions.html#cb300-5" aria-hidden="true" tabindex="-1"></a>g_condition <span class="sc">/</span> g_age</span></code></pre></div>
<p><img src="main_files/scatter%20color-1.png" width="672" /></p>
</div>
<div id="bubble-plots" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Bubble Plots</h3>
<p>A close relative of the scatter plot is the bubble plot. A bubble plot is a
scatter plot where the area of the point markers is proportional to a third
continuous dimension. Consider the plot from above, with age at death encoded as
the area of each point:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="plotting-two-or-more-dimensions.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau, <span class="at">size=</span>age_at_death)) <span class="sc">+</span></span>
<span id="cb301-2"><a href="plotting-two-or-more-dimensions.html#cb301-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="main_files/viz%20dim%20bubbl-1.png" width="672" />
In this example, the markers have been given 50% transparency, so overlapping
bubbles may be discerned more easily.</p>
<div class="box warning">
<p>Recall from the <a href="responsible-plotting.html#human-visual-perception">Human Visual Perception</a> section that it is difficult for
humans to accurately assess the relative sizes of shapes that are not near each
other. Bubble plots may be useful in some instances, but should be used
carefully.</p>
</div>
</div>
<div id="connected-scatter-plots" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Connected Scatter Plots</h3>
<p>Another close relative of the scatter plot is the connected scatter plot. A
connected scatter plot is simply a scatter plot where certain pairs of points
are connected with a line in addition to the markers. Any pairs of points may
have lines connecting them, but most often the line indicates some dimension of
time, i.e. two points that are sequential in time are connected. Below is a
connected scatter plot with a line drawn from the youngest to oldest age at
death:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="plotting-two-or-more-dimensions.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(ad_metadata,age_at_death) <span class="sc">%&gt;%</span></span>
<span id="cb302-2"><a href="plotting-two-or-more-dimensions.html#cb302-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb302-3"><a href="plotting-two-or-more-dimensions.html#cb302-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span>abeta,</span>
<span id="cb302-4"><a href="plotting-two-or-more-dimensions.html#cb302-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xend=</span><span class="fu">lag</span>(x,<span class="dv">1</span>),</span>
<span id="cb302-5"><a href="plotting-two-or-more-dimensions.html#cb302-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span>tau,</span>
<span id="cb302-6"><a href="plotting-two-or-more-dimensions.html#cb302-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">yend=</span><span class="fu">lag</span>(y,<span class="dv">1</span>)</span>
<span id="cb302-7"><a href="plotting-two-or-more-dimensions.html#cb302-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb302-8"><a href="plotting-two-or-more-dimensions.html#cb302-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb302-9"><a href="plotting-two-or-more-dimensions.html#cb302-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">xend=</span>xend, <span class="at">y=</span>tau, <span class="at">yend=</span>yend)) <span class="sc">+</span></span>
<span id="cb302-10"><a href="plotting-two-or-more-dimensions.html#cb302-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">shape=</span>condition,<span class="at">color=</span>condition),<span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="main_files/viz%20connected%20scatter-1.png" width="672" /></p>
<p>The plot suggests that perhaps the AD and Control samples might be closer in age
within groups than between. We can confirm this using another type of plot, e.g.
density grouped by condition.</p>
</div>
<div id="line-plots" class="section level3" number="7.5.4">
<h3><span class="header-section-number">7.5.4</span> Line Plots</h3>
<p>Line plots connect pairs of points with a line without drawing a symbol at each
point. The <code>geom_line()</code> function will draw lines between pairs of points sorted
by <span class="math inline">\(x\)</span> axis by default:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="plotting-two-or-more-dimensions.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>abeta, <span class="at">y=</span>tau)) <span class="sc">+</span></span>
<span id="cb303-2"><a href="plotting-two-or-more-dimensions.html#cb303-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="main_files/unnamed-chunk-122-1.png" width="672" /></p>
<p>This may be useful when plotting multiple lines using the <code>group</code> aesthetic
mapping:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="plotting-two-or-more-dimensions.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(ad_metadata,</span>
<span id="cb304-2"><a href="plotting-two-or-more-dimensions.html#cb304-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(tau,abeta,iba1,gfap),</span>
<span id="cb304-3"><a href="plotting-two-or-more-dimensions.html#cb304-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">&#39;Marker&#39;</span>,</span>
<span id="cb304-4"><a href="plotting-two-or-more-dimensions.html#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">&#39;Intensity&#39;</span></span>
<span id="cb304-5"><a href="plotting-two-or-more-dimensions.html#cb304-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb304-6"><a href="plotting-two-or-more-dimensions.html#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ad_metadata,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>ID, <span class="at">y=</span>Intensity, <span class="at">group=</span>Marker, <span class="at">color=</span>Marker)) <span class="sc">+</span></span>
<span id="cb304-7"><a href="plotting-two-or-more-dimensions.html#cb304-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="main_files/unnamed-chunk-123-1.png" width="672" /></p>
<p>This plot is similar to a <a href="parallel-coordinate-plots">parallel coordinate plot</a>,
in that all four dimensions of each sample are displayed using a position
encoding.</p>
</div>
<div id="parallel-coordinate-plots-1" class="section level3" number="7.5.5">
<h3><span class="header-section-number">7.5.5</span> Parallel Coordinate Plots</h3>
<p>Parallel coordinate plots are line plots where each of possibly many continuous
variables are given vertical position encodings and each sample has its own
line. Unlike the line plot above, each vertical axis can have a different scale,
thus allowing plots of variables with very different value ranges. The following
is a parallel coordinate plot of our AD metadata:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="plotting-two-or-more-dimensions.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb305-2"><a href="plotting-two-or-more-dimensions.html#cb305-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-3"><a href="plotting-two-or-more-dimensions.html#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(ad_metadata,</span>
<span id="cb305-4"><a href="plotting-two-or-more-dimensions.html#cb305-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb305-5"><a href="plotting-two-or-more-dimensions.html#cb305-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn=</span><span class="dv">3</span>,</span>
<span id="cb305-6"><a href="plotting-two-or-more-dimensions.html#cb305-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">showPoints=</span><span class="cn">TRUE</span></span>
<span id="cb305-7"><a href="plotting-two-or-more-dimensions.html#cb305-7" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">+</span></span>
<span id="cb305-8"><a href="plotting-two-or-more-dimensions.html#cb305-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;#bbbbbb&quot;</span>, <span class="st">&quot;#666666&quot;</span>))</span></code></pre></div>
<p><img src="main_files/viz%20pcp%20ad-1.png" width="672" /></p>
<p>All the variables have been scaled and centered to have mean zero and standard
deviation 1, and the values plotted using a position encoding vertically long
each. Each line is a different subject, and have been colored based on the type
of subject, either AD or control. This encoding allows us to make a number of
observations about the samples, e.g. except for gfap, AD samples have
consistently higher values than Controls.</p>
<div class="box note">
<p>A common way to specify colors is with a six digit
<a href="https://en.wikipedia.org/wiki/Hexadecimal">hexadecimal</a> code, e.g. <code>#2ca9f3</code>.
These codes form a triplet of (<code>rr</code>,<code>gg</code>,<code>bb</code>), where <code>rr</code> is the value of the
color red, <code>gg</code> the value of green, and <code>bb</code> for blue, examples:</p>
<ul>
<li><code>#000000</code> is the color black, or a value of zero in all three colors</li>
<li><code>#ffffff</code> is the color white, with maximum value for all three colors</li>
<li><code>#ff0000</code> is the color red, with full red value and no value for green or blue</li>
<li><code>#0000ff</code> is the color blue, with full blue value and no value for red or green</li>
<li><code>#2ca9f3</code> is <span style="color: #2ca9f3">this color</span>, a combination of red, green, and blue</li>
</ul>
<p>All colors in tidyverse may be specified with these hexadecimal color codes. See
<a href="https://en.wikipedia.org/wiki/Web_colors">web colors</a> for more information on
how to specify colors in this way.</p>
</div>
</div>
<div id="heatmaps" class="section level3" number="7.5.6">
<h3><span class="header-section-number">7.5.6</span> Heatmaps</h3>
<p>Heatmaps visualize values associated with a grid of points <span class="math inline">\((x,y,z)\)</span> as a grid
of colored rectangles, where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> define the grid point coordinates and
<span class="math inline">\(z\)</span> is a continuous value. A common heatmap you might have seen is the <a href="https://en.wikipedia.org/wiki/Weather_map">weather
map</a>, which plots current or
predicted weather patterns on top of a geographic map:</p>
<div class="figure">
<img src="weather_map.png" alt="" />
<p class="caption">Weather maps are heatmaps</p>
</div>
<p>The color at each grid coordinate, which in this case are spaced closely enough
so we cannot distinguish the boundaries between the rectangles without zooming
in, is proportional to the type and intensity of weather at that location.
In the weather map, the weather values are mapped to a <em>color scales</em> that
describe the amount of precipitation as shown in the map legend.</p>
<p>In biology, heatmaps are more typically used to visualize matrices. The concept
is the same as with the weather map, except instead of geographic coordinates
the grid corresponds to the rows and columns of a data matrix, and the color of
each grid point is mapped to a color scale chosen by the designer. The grid of
rectangles is typically not overlayed over anything, as in the weather map, but
is instead the entire visualization.</p>
<p>We can create heatmap in R using the base R
<a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/heatmap"><code>heatmap()</code></a>
function. Below is a heatmap visualization of our histological markers from the
AD example:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="plotting-two-or-more-dimensions.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># heatmap() requires a R matrix, and cannot accept a tibble or a dataframe</span></span>
<span id="cb306-2"><a href="plotting-two-or-more-dimensions.html#cb306-2" aria-hidden="true" tabindex="-1"></a>marker_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(</span>
<span id="cb306-3"><a href="plotting-two-or-more-dimensions.html#cb306-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ad_metadata,<span class="fu">c</span>(tau,abeta,iba1,gfap))</span>
<span id="cb306-4"><a href="plotting-two-or-more-dimensions.html#cb306-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb306-5"><a href="plotting-two-or-more-dimensions.html#cb306-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rownames of the matrix become y labels</span></span>
<span id="cb306-6"><a href="plotting-two-or-more-dimensions.html#cb306-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(marker_matrix) <span class="ot">&lt;-</span> ad_metadata<span class="sc">$</span>ID</span>
<span id="cb306-7"><a href="plotting-two-or-more-dimensions.html#cb306-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb306-8"><a href="plotting-two-or-more-dimensions.html#cb306-8" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(marker_matrix)</span></code></pre></div>
<p><img src="main_files/data%20viz%20marker%20heatmap-1.png" width="672" /></p>
<p>The lower right portion of the plot is the heatmap, where the matrix values are
visualized on a color gradient from light yellow to dark red.</p>
<p>More precisely, the <code>heatmap()</code> function creates a <em>clustered heatmap</em>, where
the rows and columns have been <a href="exploratory-data-analysis.html#hierarchical-clustering">hierarchically
clustered</a> separately and ordered according to how
similar they are to one another. The left and top line diagrams are
<a href="other-kind-of-plots.html#dendrograms">dendrograms</a>, which depict the similarity between rows and
columns as a tree, where the total branch length summed from one row/column to
another is proportional to the dissimilarity (i.e. numeric distance) of the two.</p>
<div class="box note">
<p>The base R <code>heatmap()</code> function performs many different operations on the input
matrix than just draw a grid of rectangles in proportion to the values. By
default, it also:</p>
<ul>
<li>performs <a href="exploratory-data-analysis.html#hierarchical-clustering">hierarchical clustering</a> of the rows and
columns using a Euclidean distance function and orders them accordingly</li>
<li>draws <a href="#dendrogram">dendrograms</a> on the rows and columns according to the
clustering</li>
<li>scales the data in the rows to have mean zero and standard deviation 1</li>
</ul>
<p>Each of these defaults can be changed by passing arguments into the function
call. The following turns off all of the extra functionality and produces only a
heatmap of the matrix:</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="plotting-two-or-more-dimensions.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb307-2"><a href="plotting-two-or-more-dimensions.html#cb307-2" aria-hidden="true" tabindex="-1"></a>  marker_matrix,</span>
<span id="cb307-3"><a href="plotting-two-or-more-dimensions.html#cb307-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Rowv=</span><span class="cn">NA</span>,</span>
<span id="cb307-4"><a href="plotting-two-or-more-dimensions.html#cb307-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Colv=</span><span class="cn">NA</span>,</span>
<span id="cb307-5"><a href="plotting-two-or-more-dimensions.html#cb307-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale=</span><span class="st">&quot;none&quot;</span>,</span>
<span id="cb307-6"><a href="plotting-two-or-more-dimensions.html#cb307-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="main_files/data%20viz%20pure%20heatmap-1.png" width="672" />
Note how the colors in this heatmap are very different for many of the
marker/sample pairs. This illustrates some of the dangers of using heatmaps,
which are described more fully in the <a href="plotting-two-or-more-dimensions.html#how-to-use-heatmaps-responsibly">How To Use Heatmaps Responsibly</a> section
below.</p>
</div>
<p>The base R heatmap function has the major drawback that no color key is provided
to indicate how values map to colors. Another heatmap
<a href="https://www.rdocumentation.org/packages/gplots/versions/3.1.1/topics/heatmap.2"><code>heatmap.2</code></a>
function in the <a href="https://cran.r-project.org/web/packages/gplots/index.html"><code>gplots</code> package</a>
which has a similar interface to <code>heatmap()</code>, but allows provides more
parameters to control the behavior of the plot and includes a color key:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="plotting-two-or-more-dimensions.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb308-2"><a href="plotting-two-or-more-dimensions.html#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(marker_matrix)</span></code></pre></div>
<p><img src="main_files/heatmap.2-1.png" width="672" /></p>
<p>The extra decoration (dashed and solid vertical lines called <em>traces</em> by the
package) provide another way to understand the magnitude of the value in each
cell. Refer to the <a href="https://www.rdocumentation.org/packages/gplots/versions/3.1.1/topics/heatmap.2"><code>gplots</code> documentation of
<code>heatmap2</code></a>
for more information on how to interpret the trace (hint: you may turn it off
with by passing the argument <code>trace = "none"</code> to the function call).</p>
<p>Both <code>heatmap()</code> and <code>heatmap.2()</code> provide a useful method to annotate rows and
columns with a categorical variable. Each of our subjects either has AD or is a
control, and we can add a color bar along the margin of the plot to indicate the
status of each subject:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="plotting-two-or-more-dimensions.html#cb309-1" aria-hidden="true" tabindex="-1"></a>condition_colors <span class="ot">&lt;-</span></span>
<span id="cb309-2"><a href="plotting-two-or-more-dimensions.html#cb309-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb309-3"><a href="plotting-two-or-more-dimensions.html#cb309-3" aria-hidden="true" tabindex="-1"></a>    ad_metadata,</span>
<span id="cb309-4"><a href="plotting-two-or-more-dimensions.html#cb309-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span><span class="fu">if_else</span>(condition <span class="sc">==</span> <span class="st">&quot;AD&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>)</span>
<span id="cb309-5"><a href="plotting-two-or-more-dimensions.html#cb309-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb309-6"><a href="plotting-two-or-more-dimensions.html#cb309-6" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(</span>
<span id="cb309-7"><a href="plotting-two-or-more-dimensions.html#cb309-7" aria-hidden="true" tabindex="-1"></a>  marker_matrix,</span>
<span id="cb309-8"><a href="plotting-two-or-more-dimensions.html#cb309-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">RowSideColors=</span>condition_colors<span class="sc">$</span>color</span>
<span id="cb309-9"><a href="plotting-two-or-more-dimensions.html#cb309-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="main_files/heatmap%20margin-1.png" width="672" /></p>
<p>And with <code>heatmap.2</code>:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="plotting-two-or-more-dimensions.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(</span>
<span id="cb310-2"><a href="plotting-two-or-more-dimensions.html#cb310-2" aria-hidden="true" tabindex="-1"></a>  marker_matrix,</span>
<span id="cb310-3"><a href="plotting-two-or-more-dimensions.html#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">RowSideColors=</span>condition_colors<span class="sc">$</span>color</span>
<span id="cb310-4"><a href="plotting-two-or-more-dimensions.html#cb310-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="main_files/heatmap.2%20margin-1.png" width="672" /></p>
<p>Heatmaps may also be created using ggplot and the
<a href="https://ggplot2.tidyverse.org/reference/geom_tile.html"><code>geom_tile</code></a> geometry.
This method of generating heatmaps is more “manual” than the other functions
covered so far, and so are both flexible and require more work to obtain certain
functionality (e.g. clustering, color bars on side margins, etc). This geometry
requires the data to be in long format, with one column for <code>x</code>, <code>y</code>, and <code>z</code>
values:</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="plotting-two-or-more-dimensions.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(</span>
<span id="cb311-2"><a href="plotting-two-or-more-dimensions.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  ad_metadata,</span>
<span id="cb311-3"><a href="plotting-two-or-more-dimensions.html#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(tau,abeta,iba1,gfap),</span>
<span id="cb311-4"><a href="plotting-two-or-more-dimensions.html#cb311-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">&quot;Marker&quot;</span>,</span>
<span id="cb311-5"><a href="plotting-two-or-more-dimensions.html#cb311-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">&quot;Intensity&quot;</span></span>
<span id="cb311-6"><a href="plotting-two-or-more-dimensions.html#cb311-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb311-7"><a href="plotting-two-or-more-dimensions.html#cb311-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Marker,<span class="at">y=</span>ID,<span class="at">fill=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb311-8"><a href="plotting-two-or-more-dimensions.html#cb311-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/heatmap%20geom%20tile-1.png" width="672" /></p>
<p>Note this ggplot method does not scale or reorder rows or columns.</p>
<div id="specifying-heatmap-colors" class="section level4" number="7.5.6.1">
<h4><span class="header-section-number">7.5.6.1</span> Specifying Heatmap Colors</h4>
<p>The colors of the heatmap may be changed by passing one of the <a href="https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/palettes.html">native color
palettes</a>
to the heatmap function with the <code>col</code> argument:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="plotting-two-or-more-dimensions.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># native R colors are:</span></span>
<span id="cb312-2"><a href="plotting-two-or-more-dimensions.html#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - rainbow(n, start=.7, end=.1)</span></span>
<span id="cb312-3"><a href="plotting-two-or-more-dimensions.html#cb312-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - heat.colors(n)</span></span>
<span id="cb312-4"><a href="plotting-two-or-more-dimensions.html#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - terrain.colors(n)</span></span>
<span id="cb312-5"><a href="plotting-two-or-more-dimensions.html#cb312-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - topo.colors(n)</span></span>
<span id="cb312-6"><a href="plotting-two-or-more-dimensions.html#cb312-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - cm.colors(n)</span></span>
<span id="cb312-7"><a href="plotting-two-or-more-dimensions.html#cb312-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the n argument specifies the number of colors (i.e. resolution) of the colormap to return</span></span>
<span id="cb312-8"><a href="plotting-two-or-more-dimensions.html#cb312-8" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(marker_matrix,<span class="at">col=</span><span class="fu">cm.colors</span>(<span class="dv">256</span>))</span></code></pre></div>
<p><img src="main_files/heatmap%20cm%20colors-1.png" width="672" /></p>
<p>To change the color using ggplot and <code>geom_tile()</code>, use the
<a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html"><code>scale_fill_gradientn</code></a>
function to specify a different color palette:</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="plotting-two-or-more-dimensions.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(</span>
<span id="cb313-2"><a href="plotting-two-or-more-dimensions.html#cb313-2" aria-hidden="true" tabindex="-1"></a>  ad_metadata,</span>
<span id="cb313-3"><a href="plotting-two-or-more-dimensions.html#cb313-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(tau,abeta,iba1,gfap),</span>
<span id="cb313-4"><a href="plotting-two-or-more-dimensions.html#cb313-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">names_to=</span><span class="st">&quot;Marker&quot;</span>,</span>
<span id="cb313-5"><a href="plotting-two-or-more-dimensions.html#cb313-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">values_to=</span><span class="st">&quot;Intensity&quot;</span></span>
<span id="cb313-6"><a href="plotting-two-or-more-dimensions.html#cb313-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb313-7"><a href="plotting-two-or-more-dimensions.html#cb313-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Marker,<span class="at">y=</span>ID,<span class="at">fill=</span>Intensity)) <span class="sc">+</span></span>
<span id="cb313-8"><a href="plotting-two-or-more-dimensions.html#cb313-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb313-9"><a href="plotting-two-or-more-dimensions.html#cb313-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors=</span><span class="fu">cm.colors</span>(<span class="dv">256</span>))</span></code></pre></div>
<p><img src="main_files/heatmap%20geom%20tile%20color%20change-1.png" width="672" />
The native color palettes in R look as follows:</p>
<p><img src="main_files/data%20viz%20heatmap%20native%20palettes-1.png" width="672" /></p>
<p>Instead of these color palettes, you may use one of the
<a href="https://colorbrewer2.org/#type=sequential&amp;scheme=BuGn&amp;n=3">ColorBrewer</a>
palettes in the <a href="https://cran.r-project.org/web/packages/RColorBrewer/index.html">RColorBrewer
package</a></p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="plotting-two-or-more-dimensions.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb314-2"><a href="plotting-two-or-more-dimensions.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="main_files/heatmap%20colorbrewer%20palettes-1.png" width="672" /></p>
<p>There are very many color palettes to choose from, and you may also create your
own palettes. Creating color palettes is <a href="https://www.r-bloggers.com/2016/07/creating-color-palettes-in-r/">somewhat
complicated</a>
in base R, but <code>ggplot()</code> provides <a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">convenient
functions</a>
<code>scale_fill_gradient()</code> and <code>scale_fill_gradient2()</code> to produce gradient scales
with 2 or 3 colors, respectively. More discussion on how to choose colors is
described in the next section.</p>
</div>
</div>
<div id="how-to-use-heatmaps-responsibly" class="section level3" number="7.5.7">
<h3><span class="header-section-number">7.5.7</span> How To Use Heatmaps Responsibly</h3>
<p>While heatmaps may seem intuitive, they are actually quite complicated and can
be difficult to create in a way that accurately depicts the underlying matrix.
As described in the <a href="responsible-plotting.html#human-visual-perception">Human Visual Perception</a> section, our visual system
estimates the hue and value of colors based on adjacent colors. For large
heatmaps with many rows and columns, it is therefore very difficult to
accurately estimate relationships across wide sections of the heatmap. This may
not always be problematic, as heatmaps might only be needed to convey general
patterns in a dataset. However, the designer has a large degree of control over
how the heatmap utilizes hue and value when mapping to the underlying numbers,
and those choices have a large impact on the interpretation of the chart. Before
data can be effectively visualized in a heatmap, some preprocessing is usually
required to yield a useful plot.</p>
<p>There are four major factors that influence how a dataset can be visualized as
a heatmap:</p>
<ol style="list-style-type: decimal">
<li>The type of features, i.e. whether the features are continuous or discrete</li>
<li>The relative scales of the features</li>
<li>The total range of the data</li>
<li>Whether or not the data are centered</li>
</ol>
<div id="the-type-of-the-features" class="section level4" number="7.5.7.1">
<h4><span class="header-section-number">7.5.7.1</span> The Type of the Features</h4>
<p>There are two broad types of features: discrete and continuous. The data
elements of a discrete feature take on one of a finite set of values. For
example, a discrete feature might include values like 0 and 1, <code>Case</code> and
<code>Control</code> or only the integers between 1 and 6. In general, we are primarily
interested to know whether samples with the same discrete value group together,
so ideally all colors that are mapped to discrete features will be easily
distinguishable from one another. As the number of possible values the feature
may take increases, finding a set of colors that are all distinguishable from
one another becomes increasingly difficult. Consider the following three
heatmaps that show different discrete data:</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="plotting-two-or-more-dimensions.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb315-2"><a href="plotting-two-or-more-dimensions.html#cb315-2" aria-hidden="true" tabindex="-1"></a>random_letters <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb315-3"><a href="plotting-two-or-more-dimensions.html#cb315-3" aria-hidden="true" tabindex="-1"></a>  letters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>,<span class="st">&#39;E&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;G&#39;</span>,<span class="st">&#39;H&#39;</span>,<span class="st">&#39;I&#39;</span>,<span class="st">&#39;J&#39;</span>)</span>
<span id="cb315-4"><a href="plotting-two-or-more-dimensions.html#cb315-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(letters[<span class="dv">1</span><span class="sc">:</span>n],<span class="dv">10</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb315-5"><a href="plotting-two-or-more-dimensions.html#cb315-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb315-6"><a href="plotting-two-or-more-dimensions.html#cb315-6" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>))</span>
<span id="cb315-7"><a href="plotting-two-or-more-dimensions.html#cb315-7" aria-hidden="true" tabindex="-1"></a>g_binary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb315-8"><a href="plotting-two-or-more-dimensions.html#cb315-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature=</span>features,</span>
<span id="cb315-9"><a href="plotting-two-or-more-dimensions.html#cb315-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">random_letters</span>(<span class="dv">2</span>),</span>
<span id="cb315-10"><a href="plotting-two-or-more-dimensions.html#cb315-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">random_letters</span>(<span class="dv">2</span>),</span>
<span id="cb315-11"><a href="plotting-two-or-more-dimensions.html#cb315-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">random_letters</span>(<span class="dv">2</span>)</span>
<span id="cb315-12"><a href="plotting-two-or-more-dimensions.html#cb315-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb315-13"><a href="plotting-two-or-more-dimensions.html#cb315-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))  <span class="sc">%&gt;%</span></span>
<span id="cb315-14"><a href="plotting-two-or-more-dimensions.html#cb315-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>feature,<span class="at">fill=</span>value)) <span class="sc">+</span> <span class="fu">geom_tile</span>()</span>
<span id="cb315-15"><a href="plotting-two-or-more-dimensions.html#cb315-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb315-16"><a href="plotting-two-or-more-dimensions.html#cb315-16" aria-hidden="true" tabindex="-1"></a>g_trinary <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb315-17"><a href="plotting-two-or-more-dimensions.html#cb315-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb315-18"><a href="plotting-two-or-more-dimensions.html#cb315-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">random_letters</span>(<span class="dv">3</span>),</span>
<span id="cb315-19"><a href="plotting-two-or-more-dimensions.html#cb315-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">random_letters</span>(<span class="dv">3</span>),</span>
<span id="cb315-20"><a href="plotting-two-or-more-dimensions.html#cb315-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">random_letters</span>(<span class="dv">3</span>)</span>
<span id="cb315-21"><a href="plotting-two-or-more-dimensions.html#cb315-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb315-22"><a href="plotting-two-or-more-dimensions.html#cb315-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))  <span class="sc">%&gt;%</span></span>
<span id="cb315-23"><a href="plotting-two-or-more-dimensions.html#cb315-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>feature,<span class="at">fill=</span>value)) <span class="sc">+</span> <span class="fu">geom_tile</span>()</span>
<span id="cb315-24"><a href="plotting-two-or-more-dimensions.html#cb315-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-25"><a href="plotting-two-or-more-dimensions.html#cb315-25" aria-hidden="true" tabindex="-1"></a>g_unmanageable <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb315-26"><a href="plotting-two-or-more-dimensions.html#cb315-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">feature=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb315-27"><a href="plotting-two-or-more-dimensions.html#cb315-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">random_letters</span>(<span class="dv">10</span>),</span>
<span id="cb315-28"><a href="plotting-two-or-more-dimensions.html#cb315-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">random_letters</span>(<span class="dv">10</span>),</span>
<span id="cb315-29"><a href="plotting-two-or-more-dimensions.html#cb315-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">random_letters</span>(<span class="dv">10</span>)</span>
<span id="cb315-30"><a href="plotting-two-or-more-dimensions.html#cb315-30" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb315-31"><a href="plotting-two-or-more-dimensions.html#cb315-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))  <span class="sc">%&gt;%</span></span>
<span id="cb315-32"><a href="plotting-two-or-more-dimensions.html#cb315-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>feature,<span class="at">fill=</span>value)) <span class="sc">+</span> <span class="fu">geom_tile</span>()</span>
<span id="cb315-33"><a href="plotting-two-or-more-dimensions.html#cb315-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb315-34"><a href="plotting-two-or-more-dimensions.html#cb315-34" aria-hidden="true" tabindex="-1"></a>g_binary <span class="sc">|</span> g_trinary <span class="sc">|</span> g_unmanageable</span></code></pre></div>
<p><img src="main_files/viz%20discrete%20heatmap-1.png" width="672" /></p>
<p>The first and second heatmaps have 2 and 3 discrete values each, and the colors
are easy to tell apart. The third heatmap has 10 discrete values and it is very
difficult to distinguish between colors in different parts of the plot.</p>
<p>Continuous features can take any of a (possibly infinite) range of real values,
e.g. <span class="math inline">\(-3.252\)</span>, <span class="math inline">\(858,352\)</span>, or <span class="math inline">\(0\)</span>. These values will be mapped to colors of a
<em>gradient</em>, where two or more colors are blended together linearly from one
color to another, and values are mapped within this range of colors in
proportion to their relative magnitudes. Two gradients, one with two colors and
one with three, are shown below:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="plotting-two-or-more-dimensions.html#cb316-1" aria-hidden="true" tabindex="-1"></a>g_two_up <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb316-2"><a href="plotting-two-or-more-dimensions.html#cb316-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="st">&#39;a&#39;</span>,</span>
<span id="cb316-3"><a href="plotting-two-or-more-dimensions.html#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb316-4"><a href="plotting-two-or-more-dimensions.html#cb316-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">val=</span>x</span>
<span id="cb316-5"><a href="plotting-two-or-more-dimensions.html#cb316-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb316-6"><a href="plotting-two-or-more-dimensions.html#cb316-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>ID,<span class="at">fill=</span>val)) <span class="sc">+</span></span>
<span id="cb316-7"><a href="plotting-two-or-more-dimensions.html#cb316-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb316-8"><a href="plotting-two-or-more-dimensions.html#cb316-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">high=</span><span class="st">&quot;#ffdddd&quot;</span>)</span>
<span id="cb316-9"><a href="plotting-two-or-more-dimensions.html#cb316-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-10"><a href="plotting-two-or-more-dimensions.html#cb316-10" aria-hidden="true" tabindex="-1"></a>g_two_down <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb316-11"><a href="plotting-two-or-more-dimensions.html#cb316-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="st">&#39;a&#39;</span>,</span>
<span id="cb316-12"><a href="plotting-two-or-more-dimensions.html#cb316-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb316-13"><a href="plotting-two-or-more-dimensions.html#cb316-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">val=</span>x</span>
<span id="cb316-14"><a href="plotting-two-or-more-dimensions.html#cb316-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb316-15"><a href="plotting-two-or-more-dimensions.html#cb316-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>ID,<span class="at">fill=</span>val)) <span class="sc">+</span></span>
<span id="cb316-16"><a href="plotting-two-or-more-dimensions.html#cb316-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb316-17"><a href="plotting-two-or-more-dimensions.html#cb316-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#ffdddd&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>)</span>
<span id="cb316-18"><a href="plotting-two-or-more-dimensions.html#cb316-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-19"><a href="plotting-two-or-more-dimensions.html#cb316-19" aria-hidden="true" tabindex="-1"></a>g_three <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb316-20"><a href="plotting-two-or-more-dimensions.html#cb316-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="st">&#39;a&#39;</span>,</span>
<span id="cb316-21"><a href="plotting-two-or-more-dimensions.html#cb316-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),</span>
<span id="cb316-22"><a href="plotting-two-or-more-dimensions.html#cb316-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">val=</span>x</span>
<span id="cb316-23"><a href="plotting-two-or-more-dimensions.html#cb316-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb316-24"><a href="plotting-two-or-more-dimensions.html#cb316-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>ID,<span class="at">fill=</span>val)) <span class="sc">+</span></span>
<span id="cb316-25"><a href="plotting-two-or-more-dimensions.html#cb316-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb316-26"><a href="plotting-two-or-more-dimensions.html#cb316-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#9999ff&quot;</span>, <span class="at">midpoint=</span><span class="fl">0.5</span>)</span>
<span id="cb316-27"><a href="plotting-two-or-more-dimensions.html#cb316-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-28"><a href="plotting-two-or-more-dimensions.html#cb316-28" aria-hidden="true" tabindex="-1"></a>g_two_up <span class="sc">/</span> g_two_down <span class="sc">/</span> g_three</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20continuous-1.png" width="672" /></p>
<p>These three example gradients comprise the most common types of color mappings.
The first two with one color differ in which color (i.e. lighter or darker) is
mapped to the largest value. The third gradient is called a <em>diverging</em> palette,
because the maximum and minimum values show divergence from some central value,
which in this case is 0.5. For diverging color palettes,
the value in the middle of the gradient is often very important, as it defines
which values are visualized in which color. More on diverging color palettes is
in the following sections.</p>
<p>In general, the types of features, i.e. discrete or continuous, must all be the
same for a heatmap to be meaningful. Once this has been determined, the values
of each feature must be examined and possibly transformed, as described next.</p>
</div>
<div id="scales-of-features" class="section level4" number="7.5.7.2">
<h4><span class="header-section-number">7.5.7.2</span> Scales of Features</h4>
<p>The second important consideration when plotting a heatmap is to understand the
nature of the different features and how they relate to one another.
Specifically, the features must all be on a comparable scale, or transformed
appropriately to attain this, for the colors in the heatmap to be visible.
Consider the following heatmap with three features plotted as columns and 10
samples as rows:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="plotting-two-or-more-dimensions.html#cb317-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb317-2"><a href="plotting-two-or-more-dimensions.html#cb317-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb317-3"><a href="plotting-two-or-more-dimensions.html#cb317-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb317-4"><a href="plotting-two-or-more-dimensions.html#cb317-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">20</span>),</span>
<span id="cb317-5"><a href="plotting-two-or-more-dimensions.html#cb317-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">5</span>)</span>
<span id="cb317-6"><a href="plotting-two-or-more-dimensions.html#cb317-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb317-7"><a href="plotting-two-or-more-dimensions.html#cb317-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))</span>
<span id="cb317-8"><a href="plotting-two-or-more-dimensions.html#cb317-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-9"><a href="plotting-two-or-more-dimensions.html#cb317-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data,<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb317-10"><a href="plotting-two-or-more-dimensions.html#cb317-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20mismatch%20scale-1.png" width="672" /></p>
<p>The scales of the different features <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> are different, namely
they have means of 0, 100, and 20, respectively. This an be clearly seen when
the data are plotted as a <a href="beeswarm-plots">beeswarm plot</a>:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="plotting-two-or-more-dimensions.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb318-2"><a href="plotting-two-or-more-dimensions.html#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb318-3"><a href="plotting-two-or-more-dimensions.html#cb318-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>value,<span class="at">color=</span>name))</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20violin-1.png" width="672" /></p>
<p>As the data are on dramatically different scales, only the feature with the
largest spread (b) can be distinguished in the heatmap.</p>
<p>In order to visualize all these data meaningfully in the same plot, the features
must be <em>scaled</em> so they are all comparable. Typically this is done by
standardizing the features to have a mean of zero and a standard deviation of 1:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="plotting-two-or-more-dimensions.html#cb319-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb319-2"><a href="plotting-two-or-more-dimensions.html#cb319-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span><span class="st">&#39;ID&#39;</span>,<span class="at">names_from=</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb319-3"><a href="plotting-two-or-more-dimensions.html#cb319-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb319-4"><a href="plotting-two-or-more-dimensions.html#cb319-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(a,b,c),scale)</span>
<span id="cb319-5"><a href="plotting-two-or-more-dimensions.html#cb319-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb319-6"><a href="plotting-two-or-more-dimensions.html#cb319-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb319-7"><a href="plotting-two-or-more-dimensions.html#cb319-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb319-8"><a href="plotting-two-or-more-dimensions.html#cb319-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20standard-1.png" width="672" />
Now each feature has a mean of zero and standard deviation of one:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="plotting-two-or-more-dimensions.html#cb320-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb320-2"><a href="plotting-two-or-more-dimensions.html#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span><span class="st">&#39;ID&#39;</span>,<span class="at">names_from=</span>name) <span class="sc">%&gt;%</span></span>
<span id="cb320-3"><a href="plotting-two-or-more-dimensions.html#cb320-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb320-4"><a href="plotting-two-or-more-dimensions.html#cb320-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(a,b,c),scale)</span>
<span id="cb320-5"><a href="plotting-two-or-more-dimensions.html#cb320-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb320-6"><a href="plotting-two-or-more-dimensions.html#cb320-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb320-7"><a href="plotting-two-or-more-dimensions.html#cb320-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb320-8"><a href="plotting-two-or-more-dimensions.html#cb320-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>value,<span class="at">color=</span>name))</span></code></pre></div>
<p><img src="main_files/viz%20standard%20violin-1.png" width="672" /></p>
<p>Now that the data are all on the same scale, each is mapped across the full
range of the color palette. In this case, we explicitly scaled each feature, but
it is possible to scale by each sample as well:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="plotting-two-or-more-dimensions.html#cb321-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb321-2"><a href="plotting-two-or-more-dimensions.html#cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span>name,<span class="at">names_from=</span>ID) <span class="sc">%&gt;%</span></span>
<span id="cb321-3"><a href="plotting-two-or-more-dimensions.html#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb321-4"><a href="plotting-two-or-more-dimensions.html#cb321-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&#39;F&#39;</span>),scale)</span>
<span id="cb321-5"><a href="plotting-two-or-more-dimensions.html#cb321-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb321-6"><a href="plotting-two-or-more-dimensions.html#cb321-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">&#39;F&#39;</span>),<span class="at">names_to=</span><span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb321-7"><a href="plotting-two-or-more-dimensions.html#cb321-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb321-8"><a href="plotting-two-or-more-dimensions.html#cb321-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20scale%20row-1.png" width="672" /></p>
<p>This result is dramatically different, and possibly not what you intended. In
this case the effect is somewhat obvious - all the values in b are the largest,
the values in c are the smallest, and c is in between. However, in general this
may not be the case, and care should be taken to understand which dimension of
the data has been scaled.</p>
<div class="box warning">
<p>Because features are typically not assumed to be on the same scale, the base R
<code>heatmap()</code> and <code>heatmap2()</code> functions <strong>automatically scale the rows of the
data prior to visualization</strong>.</p>
</div>
</div>
<div id="total-data-range" class="section level4" number="7.5.7.3">
<h4><span class="header-section-number">7.5.7.3</span> Total data range</h4>
<p>As we saw in the previous section on scaling features, the color mapping is
highly sensitive to the range of all values in the data. Even if the features or
samples have been properly scaled, extreme values in any of the features can
render a heatmap uninformative. Consider the following heatmap that visualizes
data that have a single extreme outlier:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="plotting-two-or-more-dimensions.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb322-2"><a href="plotting-two-or-more-dimensions.html#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb322-3"><a href="plotting-two-or-more-dimensions.html#cb322-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb322-4"><a href="plotting-two-or-more-dimensions.html#cb322-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb322-5"><a href="plotting-two-or-more-dimensions.html#cb322-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">9</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="fl">1e9</span>)</span>
<span id="cb322-6"><a href="plotting-two-or-more-dimensions.html#cb322-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb322-7"><a href="plotting-two-or-more-dimensions.html#cb322-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb322-8"><a href="plotting-two-or-more-dimensions.html#cb322-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb322-9"><a href="plotting-two-or-more-dimensions.html#cb322-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20outlier-1.png" width="672" /></p>
<p>The single extreme value compressed all the other color values to the colors on
the lowest end of the color palette. This anomalous value must be removed before
differences between the other variables will be visible.</p>
<p>The issue above is caused by the fact that the default color gradient scales
assume there is a linear mapping between the values and the palette. This is
equivalent to assuming the data are relatively well distributed across a linear
range of values, as in a normal or uniform distribution. When the data do not
follow this assumption, any resulting heatmaps may suffer the same issue as
when there are extreme values. Consider the following heatmap with data randomly
sampled from an exponential distribution:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="plotting-two-or-more-dimensions.html#cb323-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb323-2"><a href="plotting-two-or-more-dimensions.html#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb323-3"><a href="plotting-two-or-more-dimensions.html#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="dv">10</span><span class="sc">**</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb323-4"><a href="plotting-two-or-more-dimensions.html#cb323-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="dv">10</span><span class="sc">**</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb323-5"><a href="plotting-two-or-more-dimensions.html#cb323-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="dv">10</span><span class="sc">**</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb323-6"><a href="plotting-two-or-more-dimensions.html#cb323-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb323-7"><a href="plotting-two-or-more-dimensions.html#cb323-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))</span>
<span id="cb323-8"><a href="plotting-two-or-more-dimensions.html#cb323-8" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb323-9"><a href="plotting-two-or-more-dimensions.html#cb323-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb323-10"><a href="plotting-two-or-more-dimensions.html#cb323-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div>
<p><img src="main_files/viz%20exponential-1.png" width="672" /></p>
<p>The data are similarly compressed toward the lower end of the scale due to the
uneven distribution of data. In this case, we might consider taking a log
transformation of the data prior to drawing the heatmap:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="plotting-two-or-more-dimensions.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(data,</span>
<span id="cb324-2"><a href="plotting-two-or-more-dimensions.html#cb324-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">value=</span><span class="fu">log10</span>(value)</span>
<span id="cb324-3"><a href="plotting-two-or-more-dimensions.html#cb324-3" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">%&gt;%</span></span>
<span id="cb324-4"><a href="plotting-two-or-more-dimensions.html#cb324-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb324-5"><a href="plotting-two-or-more-dimensions.html#cb324-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() </span></code></pre></div>
<p><img src="main_files/viz%20heatmap%20log-1.png" width="672" /></p>
<p>On a log scale, the heatmap visualizes the range of values linearly across the
gradient. In this case, we knew a log transform was appropriate to cast the
data onto an approximately linear scale, though in general this will need to be
explored for each dataset.</p>
</div>
<div id="whether-or-not-the-data-are-centered" class="section level4" number="7.5.7.4">
<h4><span class="header-section-number">7.5.7.4</span> Whether or not the data are centered</h4>
<p>The final important consideration when creating a heatmap with continuous values
is determining if there is a meaningful center for each feature. For certain
kinds of data, data points above and below a certain value have a particular
meaning. For example, log2 fold change values from differential expression
greater or less than zero indicate a gene is increased or decreased,
respectively, in the comparison of interest. When visualizing these values as a
heatmap, it is therefore important to indicate this central value with a color,
usually white or black, appropriately, so that colors above and below this
value can be set accordingly, e.g. above zero is red, below zero blue.</p>
<p>To do this, first a 3-color diverging palette is required, i.e. a palette with
one color on one side, a different color on the other side, and a third color in
the middle, usually white or black. The following is a heatmap of normally
distributed values with mean 0 and standard deviation of 1 visualized on a
diverging color scale:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="plotting-two-or-more-dimensions.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb325-2"><a href="plotting-two-or-more-dimensions.html#cb325-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb325-3"><a href="plotting-two-or-more-dimensions.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb325-4"><a href="plotting-two-or-more-dimensions.html#cb325-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb325-5"><a href="plotting-two-or-more-dimensions.html#cb325-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb325-6"><a href="plotting-two-or-more-dimensions.html#cb325-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb325-7"><a href="plotting-two-or-more-dimensions.html#cb325-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb325-8"><a href="plotting-two-or-more-dimensions.html#cb325-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb325-9"><a href="plotting-two-or-more-dimensions.html#cb325-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb325-10"><a href="plotting-two-or-more-dimensions.html#cb325-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">midpoint=</span><span class="dv">0</span>)</span></code></pre></div>
<p><img src="main_files/viz-1.png" width="672" /></p>
<p>Note the <code>scale_fill_gradient2()</code> call, with <code>midpoint=0</code> argument. This
argument instructs the gradient to set the value of 0 to the middle color, which
is white. The midpoint of zero is default, but if your data are centered around
some other value, failing to specify this midpoint will produce misleading
visualizations:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="plotting-two-or-more-dimensions.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb326-2"><a href="plotting-two-or-more-dimensions.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb326-3"><a href="plotting-two-or-more-dimensions.html#cb326-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb326-4"><a href="plotting-two-or-more-dimensions.html#cb326-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb326-5"><a href="plotting-two-or-more-dimensions.html#cb326-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb326-6"><a href="plotting-two-or-more-dimensions.html#cb326-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb326-7"><a href="plotting-two-or-more-dimensions.html#cb326-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb326-8"><a href="plotting-two-or-more-dimensions.html#cb326-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb326-9"><a href="plotting-two-or-more-dimensions.html#cb326-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb326-10"><a href="plotting-two-or-more-dimensions.html#cb326-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>)</span></code></pre></div>
<p><img src="main_files/viz%20improper%20midpoint-1.png" width="672" /></p>
<p>Here our data are centered with a mean of 1, but the midpoint is still at its
default of zero. If we intend for 1 to be the midpoint corresponding to the
color white, we must specify it explicitly:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="plotting-two-or-more-dimensions.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb327-2"><a href="plotting-two-or-more-dimensions.html#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb327-3"><a href="plotting-two-or-more-dimensions.html#cb327-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb327-4"><a href="plotting-two-or-more-dimensions.html#cb327-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb327-5"><a href="plotting-two-or-more-dimensions.html#cb327-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb327-6"><a href="plotting-two-or-more-dimensions.html#cb327-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb327-7"><a href="plotting-two-or-more-dimensions.html#cb327-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c)) <span class="sc">%&gt;%</span></span>
<span id="cb327-8"><a href="plotting-two-or-more-dimensions.html#cb327-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb327-9"><a href="plotting-two-or-more-dimensions.html#cb327-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb327-10"><a href="plotting-two-or-more-dimensions.html#cb327-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>, <span class="at">mid=</span><span class="st">&quot;#ffffff&quot;</span>, <span class="at">high=</span><span class="st">&quot;#990000&quot;</span>, <span class="at">midpoint=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="main_files/viz%20correct%20midpoint-1.png" width="672" /></p>
<p>If your features do not have a meaningful center, then the color palette scale
should generally have only two colors that range from either light to dark or
dark to light:</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="plotting-two-or-more-dimensions.html#cb328-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb328-2"><a href="plotting-two-or-more-dimensions.html#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID=</span><span class="fu">paste0</span>(<span class="st">&#39;F&#39;</span>,<span class="fu">seq</span>(<span class="dv">10</span>)),</span>
<span id="cb328-3"><a href="plotting-two-or-more-dimensions.html#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">a=</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb328-4"><a href="plotting-two-or-more-dimensions.html#cb328-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">b=</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb328-5"><a href="plotting-two-or-more-dimensions.html#cb328-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">c=</span><span class="fu">runif</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb328-6"><a href="plotting-two-or-more-dimensions.html#cb328-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb328-7"><a href="plotting-two-or-more-dimensions.html#cb328-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(a,b,c))</span>
<span id="cb328-8"><a href="plotting-two-or-more-dimensions.html#cb328-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-9"><a href="plotting-two-or-more-dimensions.html#cb328-9" aria-hidden="true" tabindex="-1"></a>g_up <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb328-10"><a href="plotting-two-or-more-dimensions.html#cb328-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb328-11"><a href="plotting-two-or-more-dimensions.html#cb328-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#000099&quot;</span>,<span class="at">high=</span><span class="st">&quot;#eeeeff&quot;</span>)</span>
<span id="cb328-12"><a href="plotting-two-or-more-dimensions.html#cb328-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-13"><a href="plotting-two-or-more-dimensions.html#cb328-13" aria-hidden="true" tabindex="-1"></a>g_dn <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>name,<span class="at">y=</span>ID,<span class="at">fill=</span>value)) <span class="sc">+</span></span>
<span id="cb328-14"><a href="plotting-two-or-more-dimensions.html#cb328-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb328-15"><a href="plotting-two-or-more-dimensions.html#cb328-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">&quot;#ffffff&quot;</span>,<span class="at">high=</span><span class="st">&quot;#000099&quot;</span>)</span>
<span id="cb328-16"><a href="plotting-two-or-more-dimensions.html#cb328-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-17"><a href="plotting-two-or-more-dimensions.html#cb328-17" aria-hidden="true" tabindex="-1"></a>g_up <span class="sc">|</span> g_dn</span></code></pre></div>
<p><img src="main_files/viz%20two%20color-1.png" width="672" /></p>
<p>The direction of the color palette depends on the meaning of the data, and is
a subjective choice.</p>

</div>
</div>
</div>
<p style="text-align: center;">
<a href="visualizing-distributions.html"><button class="btn btn-default">Previous</button></a>
<a href="other-kind-of-plots.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
